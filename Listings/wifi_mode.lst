C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE WIFI_MODE
OBJECT MODULE PLACED IN .\Objects\wifi_mode.obj
COMPILER INVOKED BY: D:\ProgramFiles\Keil_v5\C51\BIN\C51.EXE source\wifi_mode.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\
                    -include) DEBUG OBJECTEXTEND PRINT(.\Listings\wifi_mode.lst) OBJECT(.\Objects\wifi_mode.obj)

line level    source

   1          //Í·ÎÄ¼şheader file//
   2          #include "app_main.h"
   3          
   4          //ºê¶¨Òåmacro definition//
   5          
   6          //ÀàĞÍ¶¨Òåbyte definition//
   7          
   8          //±äÁ¿¶¨Òåvariable definition//
   9          uint8_t  code Week_Table[]={0x01,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
  10          
  11          char  code SPASongs_Num_Table[7][24]= 
  12          {
  13                  "$$${MusicStatus:[07]}\r\n",//Ã»ÓĞ²¥·Å£¬
  14                  "$$${MusicStatus:[01]}\r\n",//µÚÒ»Ê×
  15                  "$$${MusicStatus:[02]}\r\n",
  16                  "$$${MusicStatus:[03]}\r\n",
  17                  "$$${MusicStatus:[04]}\r\n",
  18                  "$$${MusicStatus:[05]}\r\n",
  19                  "$$${MusicStatus:[06]}\r\n",
  20          };  
  21          
  22          //±êÖ¾Î´¶¨Òåflags definetion//
  23          
  24          //º¯ÊıÉùÃ÷Function declaration//
  25          //void Program1_LaterNum();
  26          
  27          //º¯Êı¶¨Òåfunction definetion//
  28          /*******************************************************************
  29          º¯ÊıÔ­ĞÍ£º
  30          ÊäÈë²ÎÊı£º
  31          Êä³ö²ÎÊı£º
  32          º¯Êı¹¦ÄÜ£º±È½Ï»ñµÃµÄ¿ØÖÆÖ¸ÁîÓëÔ¤ÏÈÉè¶¨µÄÖ¸Áî¶Ô±ÈÊÇ·ñÒ»ÖÂ£¬Èç¹ûÒ»ÖÂ¾ÍÖ´ĞĞÏà¹Ø¹¦ÄÜ£¬·ñÔòÎŞ²Ù×÷
  33          *******************************************************************/
  34          uint8_t char_compare( char *source,  char *dest)
  35          {
  36   1              while(*dest)
  37   1              {       
  38   2                      if((*source!=*dest)||(*source==0)||(*dest==0))
  39   2                              return 1;
  40   2                      source++;
  41   2                      dest++;
  42   2              }
  43   1              return 0;
  44   1      }
  45          
  46          /*******************************************************************
  47          º¯ÊıÔ­ĞÍ£º
  48          ÊäÈë²ÎÊı£º
  49          Êä³ö²ÎÊı£º
  50          º¯Êı¹¦ÄÜ£º°Ñ×Ö·û×ª»¯Îª´úÂë
  51          *******************************************************************/
  52          char char_to_hex(char indata1,char indata2)
  53          {
  54   1              if(indata1>='A')
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 2   

  55   1                      indata1=((indata1-'A')+0x0A);
  56   1              else
  57   1                      indata1=(indata1-'0');
  58   1              if(indata2>='A')
  59   1                      indata2=((indata2-'A')+0x0A);
  60   1              else
  61   1                      indata2=(indata2-'0');
  62   1              return ((indata1<<4)|indata2);
  63   1      }
  64          
  65          /*******************************************************************
  66          º¯ÊıÔ­ĞÍ£º
  67          ÊäÈë²ÎÊı£º
  68          Êä³ö²ÎÊı£º
  69          º¯Êı¹¦ÄÜ£º°Ñ×Ö·û×ª»¯Îª´úÂë
  70          *******************************************************************/
  71          char char_to_bcd(char indata1,char indata2)
  72          {
  73   1              if(indata1>='A')
  74   1                      indata1=((indata1-'A')+0x0A);
  75   1              else
  76   1                      indata1=(indata1-'0');
  77   1              if(indata2>='A')
  78   1                      indata2=((indata2-'A')+0x0A);
  79   1              else
  80   1                      indata2=(indata2-'0');
  81   1              return (indata1*10+indata2);
  82   1      }
  83          
  84          /*******************************************************************
  85          º¯ÊıÔ­ĞÍ£º
  86          ÊäÈë²ÎÊı£º
  87          Êä³ö²ÎÊı£º
  88          º¯Êı¹¦ÄÜ£º°ÑÒª·¢ËÍµÄĞ­Òé×ª»¯Îª×Ö·û
  89          *******************************************************************/
  90          void hex_to_char(uint8_t *p,uint8_t indata)
  91          {
  92   1              uint8_t tmp;
  93   1              tmp=indata>>4;
  94   1              if(tmp>=0x0A)
  95   1               *p=((tmp-0x0A)+'A'); 
  96   1              else
  97   1               *p=(tmp+'0');
  98   1              p++;
  99   1              tmp=indata&0x0F;
 100   1              if(tmp>=0x0A)
 101   1                      *p=((tmp-0x0A)+'A'); 
 102   1              else
 103   1                      *p=(tmp+'0');
 104   1      }
 105          
 106          /*******************************************************************
 107          º¯ÊıÔ­ĞÍ£º
 108          ÊäÈë²ÎÊı£º
 109          Êä³ö²ÎÊı£º
 110          º¯Êı¹¦ÄÜ£º°ÑÒª·¢ËÍµÄĞ­Òé×ª»¯Îª×Ö·û
 111          *******************************************************************/
 112          void hex_to_char_3bit(uint8_t *p, uint8_t indata)
 113          {
 114   1              uint8_t tmp;
 115   1              tmp = indata >> 8;
 116   1              if (tmp >= 0x0A)
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 3   

 117   1                      *p = ((tmp - 0x0A) + 'A');
 118   1              else
 119   1                      *p = (tmp + '0');
 120   1              p++;
 121   1              tmp = (indata&0x0FF) >> 4;
 122   1              if (tmp >= 0x0A)
 123   1                      *p = ((tmp - 0x0A) + 'A');
 124   1              else
 125   1                      *p = (tmp + '0');
 126   1              tmp = indata & 0x00F;
 127   1              if (tmp >= 0x0A)
 128   1                      *p = ((tmp - 0x0A) + 'A');
 129   1              else
 130   1                      *p = (tmp + '0');
 131   1      }
 132          
 133          /*******************************************************************
 134          º¯ÊıÔ­ĞÍ£º
 135          ÊäÈë²ÎÊı£º
 136          Êä³ö²ÎÊı£º
 137          º¯Êı¹¦ÄÜ£º¿ª»úÒª·¢ËÍµÄÃüÁîºÍÏà¹Ø²Ù×÷£¬Õâ¸ö¿ª»úÊÇ°´¼ü°´ÏÂ¿ª»úºÍ½ÓÊÕµ½¡°turn on¡±¿ª»ú£¬
 138                    ÆäËûapp·¢ËÍÑÕÉ«²¢¿ª»úÊ±GP389_ON_APP()º¯Êı
 139          *******************************************************************/
 140          void GP389_ON(void) //
 141          {
 142   1              PlayMode=PLAY_ON;
 143   1              PlayMode=((PlayMode_bk==PLAY_MUSIC)?PLAY_MUSIC:PLAY_ON);//Èç¹û¹Ø»úÊ±ÊÇmusicÄ£Ê½£¬¿ª»ú»Ø¸´´ËÄ£Ê½
 144   1              sys_volume=sys_volume_bk;
 145   1              color_mode=color_mode_bk;
 146   1              //Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);//¹Ø»úÖ®Ç°Èç¹ûÁÁ¶ÈÎª0¾Í»Ö¸´Îª1£¬·ñÔòÎª¹Ø»úÖ
             -®Ç°ÁÁ¶È//2018.4.9¹Ø»úÖ®Ç°ÁÁ¶ÈÎª0£¬¿ª»úÒ²Îª0
 147   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 148   1              
 149   1              Uart0_SendString_3Step=3;
 150   1      }
 151          
 152          /*******************************************************************
 153          º¯ÊıÔ­ĞÍ£º
 154          ÊäÈë²ÎÊı£º
 155          Êä³ö²ÎÊı£º
 156          º¯Êı¹¦ÄÜ£ºapp·¢ËÍÑÕÉ«¡¢µÆ¹â¡¢ÒôÀÖ¸ø»úÌ¨£¨´ËÊ±»úÌ¨Îª¹Ø»ú×´Ì¬£©£¬È»ºó¿ª»ú£¬³ıÁËÒôÁ¿ÆäËû²»»Ö¸´£¬
 157                    Ö»½ÓÊÜĞÂµÄ¹¦ÄÜ²Ù×÷(ÑÕÉ«¡¢µÆ¹â¡¢ÒôÀÖ)
 158          *******************************************************************/
 159          void GP389_ON_APP(void) //
 160          {
 161   1              PlayMode=PLAY_ON;
 162   1              sys_volume=sys_volume_bk;
 163   1              //Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);//¹Ø»úÖ®Ç°Èç¹ûÁÁ¶ÈÎª0¾Í»Ö¸´Îª1£¬·ñÔòÎª¹Ø»úÖ
             -®Ç°ÁÁ¶È//2018.4.9¹Ø»úÖ®Ç°ÁÁ¶ÈÎª0£¬¿ª»úÒ²Îª0
 164   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 165   1              Uart0_SendString_3Step=3;
 166   1      }
 167          
 168          /*******************************************************************
 169          º¯ÊıÔ­ĞÍ£º
 170          ÊäÈë²ÎÊı£º
 171          Êä³ö²ÎÊı£º
 172          º¯Êı¹¦ÄÜ£º°´¼ü¹Ø»úºÍapp¿ØÖÆ¹Ø»úÖ´ĞĞµÄ
 173          *******************************************************************/
 174          void GP389_OFF(void) //
 175          {
 176   1              PlayMode_bk=PlayMode;
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 4   

 177   1              PlayMode=PLAY_OFF;
 178   1              sys_volume_bk=sys_volume;
 179   1              color_mode_bk=color_mode;
 180   1              color_mode=COLOR_OFF;
 181   1              AtomizationMode1 = ATOMIZATION_OFF;
 182   1              TimerMode=cntTimer=TIMER_OFF;//
 183   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 184   1              Uart0_SendString_3Step=3;
 185   1      }
 186          
 187          /*******************************************************************
 188          º¯ÊıÔ­ĞÍ£º
 189          ÊäÈë²ÎÊı£º
 190          Êä³ö²ÎÊı£º
 191          º¯Êı¹¦ÄÜ£ºÄÖÖÓÔÚÏìÓ¦Ê±²Ù×÷ÔÚAPPÉÏµ÷ÁËµÆ¹âÁÁ¶È£¬ÒôÁ¿´óĞ¡£¬Ôò¹Ø±ÕÄÖÁå²¢¹Ø»ú£¬ÔÚappÉÏµãÁËÌØ¶¨
 192                    ÑÕÉ«µÄµÆ¹â£¬»òÕßµãÁËÌØ¶¨ÒôÀÖ£¬»òÕßµãÁËprogram,ÄÇÃ´ÄÖÖÓÍ£Ö¹£¬ÏìÓ¦ËùµãµÄ²Ù×÷
 193          *******************************************************************/
 194          //void GP389_OFF_AND_AlarmOFF()//ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 195          //{
 196          //      alarm.Runing=0;
 197          //      gbKeyNone=0;
 198          //      GP389_OFF();
 199          //      //color_mode=COLOR_OFF;
 200          //      Uart0_SendString_3Step=5;
 201          //      ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);       
 202          //      TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF;    
 203          //      return;
 204          //}
 205          
 206          /*******************************************************************
 207          º¯ÊıÔ­ĞÍ£º
 208          ÊäÈë²ÎÊı£º
 209          Êä³ö²ÎÊı£º
 210          º¯Êı¹¦ÄÜ£ºÉêÇë¿ª¹Ø»úÊ±µ÷ÓÃ´Ëº¯Êı
 211          *******************************************************************/
 212          void ApplicationGP389_ONOFF(uint8_t onoff)
 213          {//$$${GpSta:[00,00,01,01,FFFFFF,03,0A,00,01E;00,01,00,FFFFFF,03,0A,01,FF,17:3B,FF,02]}\r\n"
 214   1       //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨Ç°10¸ö×Ö¶Î£©·Ö±ğ±íÊ¾£
             -º
 215   1       //¡·ÊÇ·ñ¹Ø»ú,00ÊÇ¿ª»ú£¬01ÊÇ¹Ø»ú
 216   1       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 217   1       //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 218   1       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 219   1       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 220   1       //¡·´ú±íÁÁ¶È( 00 - 03 )
 221   1       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0A )
 222   1       //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 223   1       //¡·´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 224   1       //¡·Ó¢ÎÄ·ÖºÅ¡°;¡±¸ô¿ªÕâÁ½²¿·ÖÃüÁî
 225   1       //¡·ÄÖÖÓ¿ØÖÆĞÅÏ¢£ºÊı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨10¸ö×
             -Ö¶Î£©·Ö±ğ±íÊ¾£º
 226   1       //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 227   1       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 228   1       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 229   1       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 230   1       //¡·´ú±íÁÁ¶È( 00 - 03 )
 231   1       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 232   1       //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 233   1       //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 234   1       //  0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
 235   1       //  0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 236   1       //  0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 5   

 237   1       //  BIT            7       6    5    4    3    2    1    0
 238   1       //  ĞÇÆÚx   repeat  ÈÕ  Áù  Îå  ËÄ  Èı  ¶ş  Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î£¬ÕâÒ»´Î
 239   1       //  ÊÇÆßÌìÖ®ÄÚµÄ£¬¼ÙÈç¶¨Ê±13:00£¬²»ÖØ¸´£¬ÄÇÕâ´Î¼ÆÊ±µ½(7*24*60-1)minÖ®ºó½áÊø£¬¼´ÆßÌìÖ®ºó
 240   1       //  µÄ12:59·Ö£©
 241   1       //¡·´ú±íÄÖÖÓÊ±¼ä£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B)
 242   1       //¡·´ú±íÏìÁåÊ±¼ä£¨charÀàĞÍ1¸ö×Ö½Ú£©00-FF (µ¥Î»:·ÖÖÓ)
 243   1              char i;
 244   1              char code respGP389_AllSta[]={"$$${GpSta:[00,00,00,00,000000,00,00,00,000;00,00,00,000000,00,00,00,00,00:
             -00,00,00]}\r\n"};
 245   1              //char code respGP389_AllSta[]={"$$${GpSta:[00,00,00,00,000000,00,00,00,000;00,00,00,000000,]}\r\n"};//ÄÖ
             -ÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 246   1              do{WDT_clear();} while(Uart0_EnableSend);
 247   1              Count200ms_3Step=0;
 248   1              //Uart0_SendString_3Step=0;
 249   1              for(i=0;i<UART0_LEN_BUFFER;i++)
 250   1                      Uart0_TransmitBuffer[i]=0x00;
 251   1              //for(i=0;i<82;i++)//ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 252   1              for(i=0;i<88;i++)
 253   1                      Uart0_TransmitBuffer[i]=respGP389_AllSta[i];
 254   1              hex_to_char(&Uart0_TransmitBuffer[11],onoff);
 255   1              hex_to_char(&Uart0_TransmitBuffer[14],((PlayMode==PLAY_MUSIC)?spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹û
             -ÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 256   1              hex_to_char(&Uart0_TransmitBuffer[17],((color_mode==COLOR_OFF)?0:1));//Îª1Ê±ÊÇÒª¹Ø»ú£¬ËùÒÔÒªºÍcolor_mode_
             -bk¶Ô±È£¬Îª0ÊÇÒª¿ª»ú£¬ÒÑ¾­°Ñcolor_mode_bk¸³Öµ¸øcolor_mode
 257   1              hex_to_char(&Uart0_TransmitBuffer[20],((color_mode==COLOR_CHANGE)?1:0));
 258   1              hex_to_char(&Uart0_TransmitBuffer[23],userR_val);
 259   1              hex_to_char(&Uart0_TransmitBuffer[25],userG_val);       
 260   1              hex_to_char(&Uart0_TransmitBuffer[27],userB_val);
 261   1              hex_to_char(&Uart0_TransmitBuffer[30],Light_Brightness);
 262   1              hex_to_char(&Uart0_TransmitBuffer[33],sys_volume);
 263   1              hex_to_char(&Uart0_TransmitBuffer[36],enable_SPApause);
 264   1              hex_to_char(&Uart0_TransmitBuffer[39],Light_Brightness);//cntTimer);
 265   1              hex_to_char(&Uart0_TransmitBuffer[43],00);//ÄÖÖÓIDºÅÄ¬ÈÏÎª0   //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 266   1              hex_to_char(&Uart0_TransmitBuffer[46],00); //alarm.spa_name);//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹ûÊÇ£¬ÊÇµÚ¼¸Ê×¸è
             -£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 267   1              hex_to_char(&Uart0_TransmitBuffer[49],00); //((alarm.color_mode==COLOR_CHANGE)?1:0));//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­
             -»·½¥±äÄ£Ê½£©
 268   1              hex_to_char(&Uart0_TransmitBuffer[52],00); //alarm.userR_val);
 269   1              hex_to_char(&Uart0_TransmitBuffer[54],00); //alarm.userG_val);  
 270   1              hex_to_char(&Uart0_TransmitBuffer[56],00); //alarm.userB_val);
 271   1              hex_to_char(&Uart0_TransmitBuffer[59],00); //alarm.Brightness);//ÁÁ¶È
 272   1              hex_to_char(&Uart0_TransmitBuffer[62],00); //alarm.volume);//ÒôÁ¿
 273   1              hex_to_char(&Uart0_TransmitBuffer[65],00); //alarm.Enable); //ÄÖÖÓ×Ü¿ª¹Ø
 274   1              hex_to_char(&Uart0_TransmitBuffer[68],00); //alarm.Week);  //ÄÖÖÓÖÜ¼¸ÏìµÍ4Î»
 275   1              hex_to_char(&Uart0_TransmitBuffer[71],00); //alarm.Hour);  //ÄÖÖÓ¶¨Ê±µÄÊ±¼ä£¬Ğ¡Ê±µÍËÄÎ»
 276   1              hex_to_char(&Uart0_TransmitBuffer[74],00); //alarm.Minute);//ÄÖÖÓ¶¨Ê±µÄÊ±¼ä£¬·ÖÖÓµÍËÄÎ»
 277   1              hex_to_char(&Uart0_TransmitBuffer[77],00); //alarm.Duration);//ÄÖÖÓÏìÁåÊ±¼ä£¬µÍËÄÎ»
 278   1              hex_to_char(&Uart0_TransmitBuffer[80],AtomizationMode1);
 279   1              Uart0_SendString_3Step=2;
 280   1              Uart0_Tx_Pointer=0;
 281   1              Uart0_EnableSend=1;
 282   1              Uart0_Tx_TimeOut=20;    
 283   1              USI0DR=Uart0_TransmitBuffer[Uart0_Tx_Pointer++];
 284   1              if(cntFlag_ON_OFF==0)
 285   1                      cntFlag_ON_OFF=2;
 286   1      }
 287          
 288          /*******************************************************************
 289          º¯ÊıÔ­ĞÍ£º
 290          ÊäÈë²ÎÊı£º
 291          Êä³ö²ÎÊı£º
 292          º¯Êı¹¦ÄÜ£º´®¿Ú½ÓÊÕµ½µÄÃüÁîĞ­ÒéºÍÔ¤¶¨µÄĞ­Òé¶Ô±ÈÈ·¶¨ÊÇÄÄ¸ö½ø¶øÖ´ĞĞ²Ù×÷£¬·ñÔòÎŞ²Ù×÷
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 6   

 293          *******************************************************************/
 294          void Wifi_CommandDeal(char *Uart0_Receive)
 295          {
 296   1              uint8_t i;
 297   1              uint8_t temp_time;//ÁÙÊ±ÓÃµÄ±äÁ¿£¬ÔÚ½ÓÊÜ¶¨Ê±Ê±¼äÄÄÀï
 298   1              char *WIFI_CMD;
 299   1              WIFI_CMD=&Uart0_Receive[3];
 300   1      //      if(char_compare(WIFI_CMD,"{AlarmSet")==0)//ok  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 301   1      //      {//$$${AlarmSet:[00,01,00,01,FFFFFF,03,0A,00,00,FF,17:3B,FF,0a/20/00/12/01/01/02]}\r\n
 302   1      //       //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨10¸ö×Ö¶Î£©·Ö±ğ±íÊ¾
             -£º
 303   1      //       //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 304   1      //       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 305   1      //       //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 306   1      //       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·,£©
 307   1      //       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 308   1      //       //¡·£¨È¥µô£©´ú±íµÆÑÕÉ«µÄÏÂ±ê£¬Óëapp½çÃæÖĞµÆÒ»ÖÂ£¬·½±ãµÆ×´Ì¬Í¬²½ÔÆ¶ËºÍapp£¨00-0B£©,ÆäÖĞ00´ú±í¹ØµÆ£¬0A´ú
             -±í²ÊµÆ£¬0B´ú±í×Ô¶¨ÒåÑÕÉ«
 309   1      //       //¡·´ú±íÁÁ¶È( 00 - 03 )
 310   1      //       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 311   1      //       //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 312   1      //       //¡·(È¥µô)£º´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 313   1      //       //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 314   1      //       //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 315   1      //       //  0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
 316   1      //       //  0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 317   1      //       //  0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
 318   1      //       //  BIT      7       6    5    4    3    2    1    0
 319   1      //       //  ĞÇÆÚx  repeat    ÈÕ   Áù   Îå    ËÄ   Èı   ¶ş   Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î
 320   1      //       //¡·´ú±íÄÖÖÓ¶¨Ê±Ê±¼äµã£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B)
 321   1      //       //¡·´ú±íÏìÁåÊ±¼ä£¨intÀàĞÍ4¸ö×Ö½Ú£©00-FF (µ¥Î»ÓÉÇ¿´ó¶¨Òå)
 322   1      //       //¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£©
 323   1      //       //  ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ 0a/20/00/12/01/01/02
 324   1      //       //(WIFI_CMD[11]-'0')  //ProgrammaµÄIDºÅÔİÊ±Ã»ÓĞ£¬ÎªÒÔºóÀ©Õ¹Ô¤±¸   
 325   1      //              alarm.spa_name  =(WIFI_CMD[15]-'0');//µÚ¼¸Ê×¸è
 326   1      //              if(alarm.spa_name>=7)
 327   1      //                      alarm.spa_name=0;
 328   1      //              alarm.color_mode=(WIFI_CMD[18]-'0');//µÆ¹âµÄ¿ª¹Ø
 329   1      //              alarm.color_mode=(WIFI_CMD[18]=='1')?((WIFI_CMD[21]=='1')?COLOR_CHANGE:COLOR_USER):COLOR_OFF;
 330   1      //              alarm.userR_val=char_to_hex(WIFI_CMD[23],WIFI_CMD[24]);//RÖµ  
 331   1      //              alarm.userG_val=char_to_hex(WIFI_CMD[25],WIFI_CMD[26]);//GÖµ  
 332   1      //              alarm.userB_val=char_to_hex(WIFI_CMD[27],WIFI_CMD[28]);//BÖµ  
 333   1      //              alarm.Brightness=(WIFI_CMD[31]-'0');//ÁÁ¶È
 334   1      //              alarm.volume=char_to_hex(WIFI_CMD[33],WIFI_CMD[34]);//ÒôÁ¿
 335   1      //              alarm.play_pause=WIFI_CMD[37]-'0';//ÔİÍ£²¥·Å
 336   1      //              alarm.Enable=(WIFI_CMD[40]-'0');//ÄÖÖÓ×Ü¿ª¹Ø
 337   1      //              alarm.Week=char_to_hex(WIFI_CMD[42],WIFI_CMD[43]); 
 338   1      //              alarm.Hour=char_to_hex(WIFI_CMD[45],WIFI_CMD[46]);   //ÄÖÖÓÏìµÄĞ¡Ê±µã
 339   1      //              alarm.Minute=char_to_hex(WIFI_CMD[48],WIFI_CMD[49]); 
 340   1      //              alarm.Duration=char_to_hex(WIFI_CMD[51],WIFI_CMD[52]);//³ÖĞøÏìÁåÊ±¼ä£¬×ª»¯ÎªÊıÖµ
 341   1      //              IE3 &= ~0x04;           // Enable WT interrupt
 342   1      //              gRTC_Hour  =char_to_hex(WIFI_CMD[54],WIFI_CMD[55]);
 343   1      //              gRTC_Minute=char_to_hex(WIFI_CMD[57],WIFI_CMD[58]);
 344   1      //              gRTC_Sec   =char_to_hex(WIFI_CMD[60],WIFI_CMD[61]);
 345   1      //              gRTC_Week  =WIFI_CMD[73]-'0';
 346   1      //              gRTC_Week=Week_Table[gRTC_Week];
 347   1      //              IE3 |= 0x04;            // Enable WT interrupt
 348   1      //              if((alarm.Enable)&&(!(alarm.Week&0x7F)))
 349   1      //               Flag_alarm_wake_only=1;
 350   1      //              else
 351   1      //               Flag_alarm_wake_only=0;
 352   1      //      }
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 7   

 353   1      //      else if(char_compare(WIFI_CMD,"{AlarmOnOff")==0)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 354   1      //      {//$$${AlarmOnOff:[00,00,10/21/33/12/01/1D/01]}\r\n
 355   1      //       //¡·´ú±í Alarm µÄ ID ºÅ 
 356   1      //       //¡·´ú±íÄÖÖÓµÄ¿ª¹Ø
 357   1      //       //¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£©
 358   1      //       //      ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ  0a/20/00/12/01/01/02
 359   1      //       //(WIFI_CMD[11]-'0')  //ProgrammaµÄIDºÅÔİÊ±Ã»ÓĞ£¬ÎªÒÔºóÀ©Õ¹Ô¤±¸   
 360   1      //              alarm.Enable=(WIFI_CMD[17]-'0'); 
 361   1      //              IE3 &= ~0x04;           // Enable WT interrupt
 362   1      //              gRTC_Hour    =char_to_hex(WIFI_CMD[19],WIFI_CMD[20]);
 363   1      //              gRTC_Minute  =char_to_hex(WIFI_CMD[22],WIFI_CMD[23]);
 364   1      //              gRTC_Sec     =char_to_hex(WIFI_CMD[25],WIFI_CMD[26]);
 365   1      //              gRTC_Week    =WIFI_CMD[38]-'0';
 366   1      //              gRTC_Week=Week_Table[gRTC_Week];
 367   1      //              IE3 |= 0x04;            // Enable WT interrupt
 368   1      //              if((alarm.Enable)&&(!(alarm.Week&0x7F)))
 369   1      //               Flag_alarm_wake_only=1;
 370   1      //              else
 371   1      //               Flag_alarm_wake_only=0;
 372   1      //      }
 373   1                      if(char_compare(WIFI_CMD, "Turn on unit")==0) 
 374   1                      {//$$$Turn on unit\r\n
 375   2                              Uart0Transmit_SendString(Uart0_Receive);
 376   2                              if(PlayMode==PLAY_OFF)
 377   2                              {
 378   3                                      GP389_ON();     
 379   3                                      //ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 380   3                                      return;
 381   3                              }
 382   2                      }
 383   1                      else if(char_compare(WIFI_CMD, "Turn on Lightr")==0)
 384   1                      {//$$$Turn on Lightr\r\n
 385   2                              Uart0Transmit_SendString(Uart0_Receive);
 386   2                              if(PlayMode==PLAY_OFF)
 387   2                                      GP389_ON_APP(); 
 388   2      //                      if(alarm.Runing)//Õâ¸öÒ»¶¨ÊÇ¿ª»ú×´Ì¬²Å½øÈ¥  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 389   2      //                      {
 390   2      //                              alarm.Runing=0;
 391   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 392   2      //                      }
 393   2                              color_mode=color_mode_bk;
 394   2                              if(color_mode==COLOR_OFF)
 395   2                                      color_mode=COLOR_WHITE;
 396   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
 397   2                              return;
 398   2                      }
 399   1                      else if(char_compare(WIFI_CMD, "Change light color")==0)  
 400   1                      {//$$$Change light color Allplay\r\n
 401   2                              Uart0Transmit_SendString(Uart0_Receive);
 402   2                              if(PlayMode==PLAY_OFF)
 403   2                                      GP389_ON_APP();
 404   2      //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 405   2      //                      {//Õâ¸öÒ»¶¨ÊÇ¿ª»úÇé¿öÏÂ½øÈëµÄ
 406   2      //                              alarm.Runing=0;
 407   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 408   2      //                      }
 409   2                              color_mode=COLOR_CHANGE;
 410   2                              play_rgb_index=0;
 411   2                              curR_val=0;
 412   2                              curG_val=0;
 413   2                              curB_val=0;
 414   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 8   

 415   2                              return;
 416   2                      } 
 417   1                      else if(char_compare(WIFI_CMD, "User color")==0) 
 418   1                      {//$$$User color FFFFFF\r\n(000000-FFFFFF)
 419   2                              Uart0Transmit_SendString(Uart0_Receive);
 420   2                              if(PlayMode==PLAY_OFF)
 421   2                                      GP389_ON_APP();
 422   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 423   2      //                      {
 424   2      //                              alarm.Runing=0;
 425   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 426   2      //                      }
 427   2                              userR_val=char_to_hex(WIFI_CMD[11],WIFI_CMD[12]);
 428   2                              userG_val=char_to_hex(WIFI_CMD[13],WIFI_CMD[14]);
 429   2                              userB_val=char_to_hex(WIFI_CMD[15],WIFI_CMD[16]);
 430   2                              color_mode=COLOR_USER;
 431   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
 432   2                              return;
 433   2                      }
 434   1                      else if(char_compare(WIFI_CMD, "Select Sound file")==0) 
 435   1                      {//$$$Select Sound file to play01\r\n
 436   2                              Uart0Transmit_SendString(Uart0_Receive);
 437   2                              if(PlayMode==PLAY_OFF)
 438   2                                      GP389_ON_APP();
 439   2      //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 440   2      //                      {
 441   2      //                              alarm.Runing=0;
 442   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 443   2      //                      }
 444   2                              enableMute=0;//½âmute
 445   2                              enable_SPApause=0;
 446   2                              PlayMode=PLAY_MUSIC;
 447   2                              spa_name=WIFI_CMD[26]-'0';
 448   2                              if(cur_spa_name==spa_name)
 449   2                                      spa_cmd=SPA_PALY;
 450   2                              Uart0_SendString_3Step=1;
 451   2                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 452   2                              return;
 453   2                      }
 454   1                      else if(char_compare(WIFI_CMD, "music play")==0)
 455   1                      {//$$$music play\r\n
 456   2                              //Uart0Transmit_SendString(Uart0_Receive);
 457   2                              if(PlayMode==PLAY_OFF)
 458   2                                      GP389_ON_APP();
 459   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 460   2      //                      {
 461   2      //                              alarm.Runing=0;
 462   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 463   2      //                      }
 464   2                              PlayMode=PLAY_MUSIC;
 465   2                              enableMute=0;     //½â³ı¾²Òô
 466   2                              enable_SPApause=0;//Îª0±íÊ¾²¥·Å
 467   2                              if(spa_name==SPA_OFF) //spa_nameÎªÃ¶¾Ù±äÁ¿ÀàĞÍ£¬SPA_ZENÎªÃ¶¾Ù±äÁ¿ÔªËØ
 468   2                                      spa_name=SPA_BROOK;
 469   2                              else
 470   2                                      spa_cmd=SPA_PALY;                       
 471   2                              /*if(PlayMode==PLAY_BT)
 472   2                              {
 473   2                                      if(flag_bt_play)
 474   2                                      {
 475   2                                              bt_cmd=BT_PALY;//Ğ­ÒéÀïÃæÊÇÒ»ÌõÃüÁî£¬ËùÒÔ²¥·Å/ÔİÍ£¶¼Òª·¢ËÍÕâÌõ
 476   2                                      }
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 9   

 477   2                              }*/
 478   2                              return;
 479   2                      }
 480   1                      else if(char_compare(WIFI_CMD,"ProPlay\r\n")==0)//½ÓÊÕµ½¾Í²¥·Å×îºóµÄ½ÓÊÕµ½µÄ$$${Program:[00,01,01,00,FFF
             -FFF,03,0A,00,1E]}\r\nÊı¾İ
 481   1                      {//$$${Program
 482   2                              Uart0Transmit_SendString(Uart0_Receive);
 483   2                              if(PlayMode==PLAY_OFF)
 484   2                                      GP389_ON_APP();
 485   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 486   2      //                      {
 487   2      //                              alarm.Runing=0;
 488   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 489   2      //                      }
 490   2                              spa_name=program1.spa_name;
 491   2                              color_mode=program1.color_mode;
 492   2                              userR_val=program1.userR_val;
 493   2                              userG_val=program1.userG_val;
 494   2                              userB_val=program1.userB_val;
 495   2                              Light_Brightness=program1.Light_Brightness;
 496   2                              sys_volume=program1.sys_volume;
 497   2                              PlayMode=program1.PlayMode;
 498   2                              enable_SPApause=program1.enable_SPApause;
 499   2                              program1.enableMute=enableMute=((enable_SPApause==0)?0:1);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔ
             -ÊĞí²¥·Å¾Í²¥·Å
 500   2                              spa_cmd=((enable_SPApause==0)?SPA_PALY:SPA_PAUSE);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔÊĞí²¥·Å¾
             -Í²¥·Å
 501   2                              TimerMode=program1.TimerMode;
 502   2                              return;
 503   2                      } 
 504   1                      else if (char_compare(WIFI_CMD, "Turn on Humidifier") == 0)
 505   1                      {//$$$Turn on/off Humidifier\r\n
 506   2                              Uart0Transmit_SendString(Uart0_Receive);
 507   2                              if (PlayMode == PLAY_OFF)
 508   2                                      GP389_ON_APP();
 509   2                              //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 510   2                              //                      {
 511   2                              //                              alarm.Runing=0;
 512   2                              //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 513   2                              //                      }
 514   2                              if(AtomizationMode1==ATOMIZATION_OFF) //ÕâÒ»ÌõÊÇÅÂÔÚÎí»¯Æ÷ÒÑ¾­¿ªÆô²¢ÇÒ²»ÔÙ×îĞ¡µµÎ»£¬È»ºóÓÖ½ÓÊÕµ½¿ª»úÃüÁ
             -î±»Ç¿ĞĞ¸ü¸ÄÎª×îĞ¡¶şÉèÁ¢µÄ
 515   2                                      AtomizationMode1 = ATOMIZATION_THREE;
 516   2                              return;
 517   2                      }
 518   1                      else if (char_compare(WIFI_CMD, "Turn off Humidifier") == 0)
 519   1                      {//$$$Turn on/off Humidifier\r\n
 520   2                              Uart0Transmit_SendString(Uart0_Receive);
 521   2                              if (PlayMode == PLAY_OFF)
 522   2                                      GP389_ON_APP();
 523   2                              //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 524   2                              //                      {
 525   2                              //                              alarm.Runing=0;
 526   2                              //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 527   2                              //                      }
 528   2                              AtomizationMode1 = ATOMIZATION_OFF;
 529   2                              return;
 530   2                      }
 531   1      //              else if(char_compare(WIFI_CMD,"{Program")==0)//¹Ø»ú×´Ì¬ÏÂ´ò¿ª
 532   1      //              {//$$${Program:[00,01,01,00,FFFFFF,03,0A,00,1E]}\r\n
 533   1      //                      Uart0Transmit_SendString(Uart0_Receive);
 534   1      //                      if(PlayMode==PLAY_OFF)
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 10  

 535   1      //                              GP389_ON_APP();
 536   1      //                      if(alarm.Runing)
 537   1      //                      {
 538   1      //                              alarm.Runing=0;
 539   1      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 540   1      //                      }
 541   1      //                      Program1_LaterNum(); //ÏÈ°ÑµÍÊı×Ö¸³¸ø¸ßÊı×Ö£¬
 542   1      //                      program1.spa_name=spa_name=WIFI_CMD[14]-'0';
 543   1      //                      program1.color_mode=color_mode=((WIFI_CMD[17]=='1')?COLOR_WHITE:COLOR_OFF);//µÆ¹âµÄ¿ª¹Ø
 544   1      //                      program1.color_mode=color_mode=((WIFI_CMD[17]=='1')?((WIFI_CMD[20]=='1')?COLOR_CHANGE:COLOR_USER):COL
             -OR_OFF);//ÏÈÅĞ¶ÏÉÏÒ»×éÊÇ·ñ¿ªÆôµÆ¹â£¬Èç¹û¿ªÆôµÆ¹â¾ÍÔÙÅĞ¶ÏÊÇ·ñ¿ªÆô²ÊµÆ£¬Èç¹û²»¿ªÆô¾ÍÊÇÓÃ»§Öµ                                                                                                                                                                                               //Ó
             -Ã»§ÖµÊÇÏÂÃæRGBµÄÖµ
 545   1      //                      program1.userR_val=userR_val=char_to_hex(WIFI_CMD[22],WIFI_CMD[23]);
 546   1      //                      program1.userG_val=userG_val=char_to_hex(WIFI_CMD[24],WIFI_CMD[25]);
 547   1      //                      program1.userB_val=userB_val=char_to_hex(WIFI_CMD[26],WIFI_CMD[27]);
 548   1      //                      program1.Light_Brightness=Light_Brightness=char_to_bcd(WIFI_CMD[29],WIFI_CMD[30]);
 549   1      //                      program1.sys_volume=sys_volume=char_to_hex(WIFI_CMD[32],WIFI_CMD[33]);//ÒôÁ¿
 550   1      //                      program1.PlayMode=PlayMode=PLAY_MUSIC;
 551   1      //                      program1.enable_SPApause=enable_SPApause=WIFI_CMD[36]-'0';
 552   1      //                      program1.enableMute=enableMute=((enable_SPApause==0)?0:1);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖ
             -ÓÔÊĞí²¥·Å¾Í²¥·Å
 553   1      //                      spa_cmd=((enable_SPApause==0)?SPA_PALY:SPA_PAUSE);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔÊĞí²¥·
             -Å¾Í²¥·Å
 554   1      //                      program1.TimerMode=TimerMode=cntTimer=char_to_hex(WIFI_CMD[38],WIFI_CMD[39]);
 555   1      //                      return;
 556   1      //              }
 557   1                      else if(char_compare(WIFI_CMD,"VER0.\r\n")==0) 
 558   1                      {
 559   2                              return;
 560   2                      }
 561   1                      else if(char_compare(WIFI_CMD,"VER\r\n")==0) 
 562   1                      {
 563   2                              Uart0Transmit_SendString(MCU_VER);//Ã¿´ÎÉı¼¶ĞèÒªÊÖ¶¯¸ÄĞ´ÕâÀï
 564   2                              return;
 565   2                      }
 566   1                      else if(char_compare(WIFI_CMD,"GpSta")==0)
 567   1                      {//×îÖÕ×´Ì¬ÊÇ¹Ø»ú
 568   2                              Uart0_SendString_3Step=0;
 569   2                              cntFlag_ON_OFF=0;
 570   2                              return;//PlayMode=PLAY_OFF;     ÒòÎªÓĞÇ¿ÖÆ¹Ø»ú£¬ËùÒÔ¿ÉÒÔ²»ÒªGP389_OFF()/GP389_ON()
 571   2                      }
 572   1      //              else if(char_compare(WIFI_CMD,"GpSta:[00]\r\n")==0)
 573   1      //              {//×îÖÕ×´Ì¬ÊÇ¿ª»ú£¬
 574   1      //                      Uart0_SendString_3Step=0;
 575   1      //                      cntFlag_ON_OFF=0;
 576   1      //                      return;//PlayMode=PLAY_OFF;     ÒòÎªÓĞÇ¿ÖÆ¹Ø»ú£¬ËùÒÔ¿ÉÒÔ²»ÒªGP389_OFF()/GP389_ON()
 577   1      //              }
 578   1              
 579   1              
 580   1              if(PlayMode!=PLAY_OFF)
 581   1              {
 582   2                      if(char_compare(WIFI_CMD,"{TimeSync")==0)
 583   2                      {//$$${TimeSync:[0A/20/00/12/01/01/02]}\r\n
 584   3                              IE3 &= ~0x04;           // Enable WT interrupt
 585   3                              gRTC_Hour  =char_to_hex(WIFI_CMD[11],WIFI_CMD[12]);
 586   3                              gRTC_Minute=char_to_hex(WIFI_CMD[14],WIFI_CMD[15]);
 587   3                              gRTC_Sec   =char_to_hex(WIFI_CMD[17],WIFI_CMD[18]);
 588   3                              gRTC_Week  =WIFI_CMD[30]-'0';
 589   3                              gRTC_Week  =Week_Table[gRTC_Week];
 590   3                              IE3 |= 0x04;            // Enable WT interrupt
 591   3                              Falg_TimeSync_Allow=0;//½ÓÊÕµ½Í¬²½ĞÅÏ¢¾Í²»ÔÙ·¢ËÍÇëÇóÍ¬²½£¬ËùÒÔÖÃÎª0
 592   3                              return;
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 11  

 593   3                      }       
 594   2                      else if(char_compare(WIFI_CMD, "Turn off unit")==0) 
 595   2                      {//ÕâÌõĞ­ÒéÃüÁîÊÇappÖ±½Ó·¢ËÍ¹ıÀ´µÄ¹Ø»úÃüÁî£¬²»ÓÃÉêÇë¾Í¿ÉÒÔ¹Ø»ú£¬µ«ÊÇÊÕµ½ÕâÌõÃüÁîÒªÅĞ¶Ï
 596   3                       //´ËÊ±²»ÓÃ½øĞĞÅĞ¶ÏÊÇ²»ÊÇÔÚ¹Ø»ú×´Ì¬£¬ÒòÎª¹Ø»úÖ®ºóĞèÒªÉè¶¨µÄ×´Ì¬¶Ô³ÌĞòÎŞÓ°Ïì£¬»òÕß¿ª»úÖ®
 597   3                       //ºó»á³õÊ¼»¯ÕâĞ©×´Ì¬
 598   3                       //$$$Turn off unit\r\n
 599   3                              Uart0Transmit_SendString(Uart0_Receive);
 600   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 601   3      //                      {
 602   3      //                              GP389_OFF_AND_AlarmOFF();
 603   3      //                              return;
 604   3      //                      }
 605   3                              
 606   3                              Uart0_SendString_3Step=3;
 607   3                              GP389_OFF();
 608   3                              //ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 609   3                              return;
 610   3                      }
 611   2                      else if(char_compare(WIFI_CMD, "Turn on BT")==0) 
 612   2                      {//$$$Turn on BT\r\n
 613   3                              PlayMode=PLAY_BT;
 614   3                      }
 615   2                      else if (char_compare(WIFI_CMD, "previous song\r\n") == 0)
 616   2                      {//$$$previous song\r\n ÉÏÒ»Ê×¸è  
 617   3                              spa_cmd = SPA_PALY;
 618   3                              if ((spa_name > SPA_OFF) && (spa_name <= SPA_ZEN))
 619   3                              {
 620   4                                      
 621   4                                      spa_name--;
 622   4                              }
 623   3                              else
 624   3                                      if (spa_name == SPA_OFF)//ĞÎ³ÉÑ­»·
 625   3                                      {
 626   4                                              spa_name = SPA_ZEN;
 627   4                                              enableMute=0; //½âmute
 628   4                                              if(enable_SPApause)
 629   4                                              {
 630   5                                                      enable_SPApause=0;
 631   5                                                      spa_cmd=SPA_PALY;
 632   5                                              }
 633   4                                      }
 634   3                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 635   3                              return;
 636   3                      }
 637   2                      else if (char_compare(WIFI_CMD, "next song\r\n") == 0)
 638   2                      {//$$$next song\r\n ÏÂÒ»Ê×¸è
 639   3                              spa_cmd = SPA_PALY;
 640   3                              if ((spa_name >= SPA_OFF) && (spa_name < SPA_ZEN))
 641   3                              {
 642   4                                      spa_name++;
 643   4                                      enableMute=0; //½âmute
 644   4                                      if(enable_SPApause)
 645   4                                      {
 646   5                                              enable_SPApause=0;
 647   5                                              spa_cmd=SPA_PALY;
 648   5                                      }
 649   4                              }
 650   3                              else
 651   3                                      if (spa_name == SPA_ZEN) //ĞÎ³ÉÑ­»·
 652   3                                              spa_name = SPA_OFF;
 653   3                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 654   3                              return;
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 12  

 655   3                      }
 656   2                      else if(char_compare(WIFI_CMD, "music pause")==0)
 657   2                      {//$$$music pause\r\n
 658   3                              if(PlayMode==PLAY_MUSIC)
 659   3                              {                                   
 660   4                                      enable_SPApause=1;
 661   4                                      spa_cmd=SPA_PAUSE;
 662   4                              }
 663   3      //                      if(PlayMode==PLAY_BT)
 664   3      //                      {
 665   3      //                              if(flag_bt_play) 
 666   3      //                              {
 667   3      //                                      bt_cmd=BT_PAUSE;//Ğ­ÒéÀïÃæÊÇÒ»ÌõÃüÁî£¬ËùÒÔ²¥·Å/ÔİÍ£¶¼Òª·¢ËÍÕâÌõ
 668   3      //                              }
 669   3      //                      }
 670   3                              return;
 671   3                      }
 672   2                      else if(char_compare(WIFI_CMD,"{MusicStatus")==0)
 673   2                      {
 674   3                              return;
 675   3                      }
 676   2                      else if(char_compare(WIFI_CMD, "Adjust Output Volume")==0)
 677   2                      {//$$$Adjust Output Volumexx\r\n£¬xx´ú±í01-10
 678   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 679   3      //                      {
 680   3      //                              GP389_OFF_AND_AlarmOFF();
 681   3      //                              return;
 682   3      //                      }
 683   3                              sys_volume=char_to_bcd(WIFI_CMD[20],WIFI_CMD[21]);
 684   3                              enableMute=0;
 685   3                      }
 686   2                      else if(char_compare(WIFI_CMD, "volume up")==0) 
 687   2                      {//$$$volume up\r\n
 688   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 689   3      //                      {
 690   3      //                              GP389_OFF_AND_AlarmOFF();
 691   3      //                              return;
 692   3      //                      }
 693   3                              sys_volume=((sys_volume < 10)?((sys_volume<=8)?(sys_volume += 2):(sys_volume += 1)):10);
 694   3                              enableMute=0;
 695   3                      }
 696   2                      else if(char_compare(WIFI_CMD, "volume down")==0) 
 697   2                      {//volume down\r\n
 698   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 699   3      //                      {
 700   3      //                              GP389_OFF_AND_AlarmOFF();
 701   3      //                              return;
 702   3      //                      }
 703   3                              sys_volume=((sys_volume > 1)?((sys_volume>=3)?(sys_volume -= 2):(sys_volume -= 1)):1);
 704   3                              enableMute=0;
 705   3                      }
 706   2                      else if(char_compare(WIFI_CMD, "music mute")==0) 
 707   2                      {//$$$music mute\r\n
 708   3                              enableMute=1;
 709   3                              return;
 710   3                      }
 711   2                      else if(char_compare(WIFI_CMD, "music unmute")==0) 
 712   2                      {//$$$music unmute\r\n
 713   3                              enableMute=0;
 714   3                              return;
 715   3                      }
 716   2                      else if(char_compare(WIFI_CMD, "Set Timer")==0)//ok
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 13  

 717   2                      {//$$$Set Timer XXX\r\n(030/060/090)
 718   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 719   3      //                      {
 720   3      //                              GP389_OFF_AND_AlarmOFF();
 721   3      //                              return;
 722   3      //                      }
 723   3                              temp_time=char_to_bcd(WIFI_CMD[10], WIFI_CMD[11]);//Ö»¼ì²âÇ°Á½¸öÊı×Ö£¬ÔÙÅĞ¶Ï
 724   3                              TimerMode=cntTimer= (temp_time == 9) ? 90 : ((temp_time == 6) ? 60 : ((temp_time == 3) ? 30 : 0));
 725   3                      }
 726   2                      else if(char_compare(WIFI_CMD, "Turn off Timer")==0)//ok
 727   2                      {//$$$Turn off Timer\r\n
 728   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 729   3      //                      {
 730   3      //                              GP389_OFF_AND_AlarmOFF();
 731   3      //                              return;
 732   3      //                      }
 733   3                              TimerMode=cntTimer=TIMER_OFF;
 734   3                      }
 735   2                      else if(char_compare(WIFI_CMD, "Turn off Lightr")==0)  
 736   2                      {//$$$Turn off Lightr\r\n
 737   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 738   3      //                      {
 739   3      //                              GP389_OFF_AND_AlarmOFF();
 740   3      //                              return;
 741   3      //                      }
 742   3                              color_mode=COLOR_OFF;
 743   3                      } 
 744   2                      else if(char_compare(WIFI_CMD,"light up")==0)
 745   2                      {//$$$light up\r\n
 746   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 747   3      //                      {
 748   3      //                              GP389_OFF_AND_AlarmOFF();
 749   3      //                              return;
 750   3      //                      }
 751   3                              if(Light_Brightness<3)
 752   3                                      Light_Brightness++;
 753   3                      }
 754   2                      else if(char_compare(WIFI_CMD,"light down")==0)
 755   2                      {//$$$light down\r\n
 756   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 757   3      //                      {
 758   3      //                              GP389_OFF_AND_AlarmOFF();
 759   3      //                              return;
 760   3      //                      }
 761   3                              if(Light_Brightness>0)
 762   3                                      Light_Brightness--;
 763   3                      }
 764   2                      else if(char_compare(WIFI_CMD,"Adjust Light Brightness")==0)
 765   2                      {//$$$Adjust Light Brightness 01\r\n(01-03)
 766   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 767   3      //                      {
 768   3      //                              GP389_OFF_AND_AlarmOFF();
 769   3      //                              return;
 770   3      //                      }
 771   3                              Light_Brightness=char_to_bcd(WIFI_CMD[24],WIFI_CMD[25]);
 772   3                      }
 773   2                      else if (char_compare(WIFI_CMD, "Adjust moist mode ") == 0)
 774   2                      {//$$$Adjust moist mode XX\r\n (01-03)
 775   3                       //                     if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 776   3                       //                     {
 777   3                       //                             GP389_OFF_AND_AlarmOFF();
 778   3                       //                             return;
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 14  

 779   3                       //                     }
 780   3                              AtomizationMode1 = char_to_bcd(WIFI_CMD[18], WIFI_CMD[19]);
 781   3                      }
 782   2      //              else if(char_compare(WIFI_CMD,"AlaGpSta\r\n")==0) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 783   2      //              {//W-G:"$$$AlaGpSta\r\n"
 784   2      //               //G-W:"$$${AlaGpSta:[00,01,01,00,FFFFFF,03,0A,00,01,FF,17:3B,FF]}\r\n"
 785   2      //               //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨13¸ö×Ö¶Î£©·Ö±ğ±íÊ
             -¾£º
 786   2      //               //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 787   2      //               //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 788   2      //               //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 789   2      //               //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 790   2      //               //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 791   2      //               //¡·´ú±íÁÁ¶È( 00 - 03 )
 792   2      //               //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 793   2      //               //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 794   2      //               //£¨È¥µô£©¡·´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 795   2      //               //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 796   2      //               //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 797   2      //               //    0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
 798   2      //               //    0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 799   2      //               //    0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
 800   2      //               //    BIT            7       6    5    4    3    2    1    0
 801   2      //               //    ĞÇÆÚx   repeat  ÈÕ  Áù  Îå  ËÄ  Èı  ¶ş  Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î£¬ÕâÒ»´Î
 802   2      //               //  ÊÇÆßÌìÖ®ÄÚµÄ£¬¼ÙÈç¶¨Ê±13:00£¬²»ÖØ¸´£¬ÄÇÕâ´Î¼ÆÊ±µ½(7*24*60-1)minÖ®ºó½áÊø£¬¼´ÆßÌìÖ®ºó
 803   2      //               //  µÄ12:59·Ö£©
 804   2      //               //¡·´ú±íÄÖÖÓ¶¨Ê±Ê±¼äµã£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B
             -)
 805   2      //               //¡·´ú±íÏìÁåÊ±¼ä£¨charÀàĞÍ1¸ö×Ö½Ú£©00-FF (µ¥Î»:·ÖÖÓ)
 806   2      //               //£¨È¥µô£©¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£© 
 807   2      //               //    ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ 0a/20/00/12/01/01/02
 808   2      //                      char  code respAlaGpSta[]={"$$${AlaGpSta:[00,00,00,00,000000,00,00,00,00,00,00:00,00]}\r\n"};
 809   2      //                      for(i=0;i<UART0_LEN_BUFFER;i++)
 810   2      //                              Uart0_Receive[i]=0x00;
 811   2      //                      for(i=0;i<62;i++)
 812   2      //                              Uart0_Receive[i]=respAlaGpSta[i];
 813   2      //                      hex_to_char(&Uart0_Receive[14],0);//IDºÅÄ¬ÈÏÎª0
 814   2      //                      hex_to_char(&Uart0_Receive[17],((alarm.spa_name!=0)?alarm.spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹û
             -ÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 815   2      //                      hex_to_char(&Uart0_Receive[20],((alarm.color_mode==COLOR_OFF)?0:1));//¿ª¹ØµÆ
 816   2      //                      hex_to_char(&Uart0_Receive[23],(((alarm.color_mode==COLOR_CHANGE)?1:0)));//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£
             -Ê½£©
 817   2      //                      hex_to_char(&Uart0_Receive[26],alarm.userR_val);
 818   2      //                      hex_to_char(&Uart0_Receive[28],alarm.userG_val);
 819   2      //                      hex_to_char(&Uart0_Receive[30],alarm.userB_val);
 820   2      //                      hex_to_char(&Uart0_Receive[33],alarm.Brightness);//ÁÁ¶È
 821   2      //                      hex_to_char(&Uart0_Receive[36],alarm.volume);//ÒôÁ¿
 822   2      //                      hex_to_char(&Uart0_Receive[39],alarm.play_pause);
 823   2      //                      hex_to_char(&Uart0_Receive[42],alarm.Enable);
 824   2      //                      hex_to_char(&Uart0_Receive[45],alarm.Week);
 825   2      //                      hex_to_char(&Uart0_Receive[48],alarm.Hour);
 826   2      //                      hex_to_char(&Uart0_Receive[51],alarm.Minute);
 827   2      //                      hex_to_char(&Uart0_Receive[54],alarm.Duration);
 828   2      //                      Uart0_SendString_3Step=2;
 829   2      //              }
 830   2                      else if(char_compare(WIFI_CMD,"NorGpSta\r\n")==0)
 831   2                      {//W-G:"$$$NorGpSta\r\n"
 832   3                       //G-W:"$$${NorGpSta:[00,00,01,01,FFFFFF,03,0A,00,01E,02]}\r\n"
 833   3                              char  code respNorGpSta[]={"$$${NorGpSta:[00,00,00,00,000000,00,00,00,000,00]}\r\n"};
 834   3                              for(i=0;i<UART0_LEN_BUFFER;i++)
 835   3                                      Uart0_Receive[i]=0x00;
 836   3                              for(i=0;i<55;i++)
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 15  

 837   3                                      Uart0_Receive[i]=respNorGpSta[i];
 838   3                              hex_to_char(&Uart0_Receive[14],1);//ÔÚÕâÀïÊÇ¿ª»ú
 839   3                              hex_to_char(&Uart0_Receive[17],((PlayMode==PLAY_MUSIC)?spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹ûÊÇ£¬Ê
             -ÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 840   3                              hex_to_char(&Uart0_Receive[20],(color_mode==COLOR_OFF)?0:1);
 841   3                              hex_to_char(&Uart0_Receive[23],(color_mode==COLOR_CHANGE)?0:1);//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£Ê½£©
 842   3                              hex_to_char(&Uart0_Receive[26],userR_val);
 843   3                              hex_to_char(&Uart0_Receive[28],userG_val);
 844   3                              hex_to_char(&Uart0_Receive[30],userB_val);
 845   3                              hex_to_char(&Uart0_Receive[33],Light_Brightness);
 846   3                              hex_to_char(&Uart0_Receive[36],sys_volume);
 847   3                              hex_to_char(&Uart0_Receive[39],enable_SPApause);
 848   3                              hex_to_char_3bit(&Uart0_Receive[42],cntTimer);
 849   3                              hex_to_char(&Uart0_Receive[46],AtomizationMode1);
 850   3                              Uart0_SendString_3Step=2;
 851   3                      }
 852   2                      else if(char_compare(WIFI_CMD," update")==0) 
 853   2                      {//mcu update+0X43A4+0X0044,½ÓÊÕµ½Õâ¸öĞÅÏ¢¿ªÊ¼Éı¼¶
 854   3                              Update_ByteSizeSum=(char_to_hex(WIFI_CMD[10],WIFI_CMD[11])<<8)|char_to_hex(WIFI_CMD[12],WIFI_CMD[13]);/
             -/¶àÉÙ¸ö×Ö½Ú£¬µØÎ»ÔÚÇ°£¬¸ßÎ»ÔÚºó
 855   3                              Update_PacketSum  =(char_to_hex(WIFI_CMD[17],WIFI_CMD[18])<<8)|char_to_hex(WIFI_CMD[19],WIFI_CMD[20]);/
             -/¶àÉÙ¸ö°ü
 856   3                              update_handle();
 857   3                      }
 858   2                      else if(char_compare(WIFI_CMD,"ATWQ\r\n")==0) 
 859   2                      {//$$$ATWQ\r\n
 860   3                              Uart0_SendString_3Step=0;
 861   3                              return;
 862   3                      }
 863   2                      else if(char_compare(WIFI_CMD,"VER\r\n")==0) 
 864   2                      {
 865   3                              Uart0Transmit_SendString(MCU_VER);//Ã¿´ÎÉı¼¶ĞèÒªÊÖ¶¯¸ÄĞ´ÕâÀï
 866   3                              return;
 867   3                      }
 868   2                      else if(char_compare(WIFI_CMD,"Enter TestMode:")==0) 
 869   2                      {
 870   3                              Uart0_SendString_3Step=0;
 871   3                              cntFlash=0;
 872   3                              Led_Flash=0;
 873   3                              setFactory=1;//ÖÃÒ»ÈÃÈı¸ötimerµÆ³£ÁÁÈıÃë
 874   3                              PlayMode=PLAY_ON;
 875   3                              bt_send_cmd(BT_CLEAR_LIST);//Çå³ıÀ¶ÑÀÁĞ±íÁĞ±í
 876   3                              return;
 877   3                      }
 878   2                      Uart0Transmit_SendString(Uart0_Receive);
 879   2                      ////////////////////////////////////////////////////////////////////////////////////
 880   2                      ////////////////////////////////////////////////////////////////////////////////////
 881   2              }
 882   1              else //¹Ø»ú×´Ì¬ÏÂ½ÓÊÕÌØ¶¨wifiÊı¾İ
 883   1              {
 884   2                      if(char_compare(WIFI_CMD,"{NorGpSta")==0)
 885   2                      {//W-G:"$$$NorGpSta\r\n"
 886   3                       //G-W:"$$${NorGpSta:[00,00,01,01,FFFFFF,03,0A,00,01E,02]}\r\n"
 887   3                              char  code respNorGpSta[] = { "$$${NorGpSta:[00,00,00,00,000000,00,00,00,000,00]}\r\n" };
 888   3                              for (i = 0; i<UART0_LEN_BUFFER; i++)
 889   3                                      Uart0_Receive[i] = 0x00;
 890   3                              for (i = 0; i<55; i++)
 891   3                                      Uart0_Receive[i] = respNorGpSta[i];
 892   3                              hex_to_char(&Uart0_Receive[14], 0);//ÔÚÕâÀïÊÇ¿ª»ú
 893   3                              hex_to_char(&Uart0_Receive[17], ((PlayMode == PLAY_MUSIC) ? spa_name : 7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç
             -¹ûÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 894   3                              hex_to_char(&Uart0_Receive[20], (color_mode == COLOR_OFF) ? 0 : 1);
C51 COMPILER V9.00   WIFI_MODE                                                             08/28/2018 08:45:53 PAGE 16  

 895   3                              hex_to_char(&Uart0_Receive[23], (color_mode == COLOR_CHANGE) ? 0 : 1);//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£Ê½£©
 896   3                              hex_to_char(&Uart0_Receive[26], userR_val);
 897   3                              hex_to_char(&Uart0_Receive[28], userG_val);
 898   3                              hex_to_char(&Uart0_Receive[30], userB_val);
 899   3                              hex_to_char(&Uart0_Receive[33], Light_Brightness);
 900   3                              hex_to_char(&Uart0_Receive[36], sys_volume);
 901   3                              hex_to_char(&Uart0_Receive[39], enable_SPApause);
 902   3                              hex_to_char_3bit(&Uart0_Receive[42], cntTimer);
 903   3                              hex_to_char(&Uart0_Receive[46], AtomizationMode1);
 904   3                              Uart0_SendString_3Step = 2;
 905   3                      }
 906   2                      Uart0Transmit_SendString(Uart0_Receive);
 907   2              }
 908   1      }
 909          
 910          /*******************************************************************
 911          º¯ÊıÔ­ĞÍ£º
 912          ÊäÈë²ÎÊı£º
 913          Êä³ö²ÎÊı£º
 914          º¯Êı¹¦ÄÜ£ºÔÚappÉÏ·¢ËÍ¡°×´Ì¬¡°¹¦ÄÜ¸ø»úÌ¨£¬×´Ì¬¹¦ÄÜÊÇÍ¬Ê±ÉèÖÃºÃ¼¸¸ö²Ù×÷£¨ÒôÀÖ£¬µÆ¹âµÈ£©£¬È»ºóÒ»Æğ·¢¹ıÀ´
 915                    È»ºó»úÌ¨¼ÇÂ¼ÏÂÀ´µÚ¼¸´Î·¢µÄ£¬°ÑĞÂµÄÒ»´Î¸´ÖÆ¸øprogram1£¬ÉÏÒ»´ÎµÄprogram1¸´ÖÆ¸øprogram2£¬ÒòÎª
 916                            Êı¾İºÍÊı¾İÀàĞÍ¶¼Ò»Ñù£¬ËùÒÔ¿ÉÒÔÖ±½Ó¸´ÖÆ
 917          *******************************************************************/
 918          //void Program1_LaterNum()
 919          //{
 920          //      program3=program2;//ÒòÎªÊı¾İºÍÊı¾İÀàĞÍÍêÈ«Ò»Ñù£¬ËùÒÔ¿ÉÒÔÖ±½Ó¸³Öµ
 921          //      program2=program1;
 922          //}
 923          
 924          
 925          
 926          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3487    ----
   CONSTANT SIZE    =    850    ----
   XDATA SIZE       =   ----      14
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
