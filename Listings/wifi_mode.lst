C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE WIFI_MODE
OBJECT MODULE PLACED IN .\Objects\wifi_mode.obj
COMPILER INVOKED BY: D:\ProgramFiles\Keil_v5\C51\BIN\C51.EXE source\wifi_mode.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\
                    -include) DEBUG OBJECTEXTEND PRINT(.\Listings\wifi_mode.lst) OBJECT(.\Objects\wifi_mode.obj)

line level    source

   1          //Í·ÎÄ¼şheader file//
   2          #include "app_main.h"
   3          
   4          //ºê¶¨Òåmacro definition//
   5          
   6          //ÀàĞÍ¶¨Òåbyte definition//
   7          
   8          //±äÁ¿¶¨Òåvariable definition//
   9          uint8_t  code Week_Table[]={0x01,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
  10          
  11          char  code SPASongs_Num_Table[7][24]= 
  12          {
  13                  "$$${MusicStatus:[07]}\r\n",//Ã»ÓĞ²¥·Å£¬
  14                  "$$${MusicStatus:[01]}\r\n",//µÚÒ»Ê×
  15                  "$$${MusicStatus:[02]}\r\n",
  16                  "$$${MusicStatus:[03]}\r\n",
  17                  "$$${MusicStatus:[04]}\r\n",
  18                  "$$${MusicStatus:[05]}\r\n",
  19                  "$$${MusicStatus:[06]}\r\n",
  20          };  
  21          
  22          //±êÖ¾Î´¶¨Òåflags definetion//
  23          
  24          //º¯ÊıÉùÃ÷Function declaration//
  25          //void Program1_LaterNum();
  26          
  27          //º¯Êı¶¨Òåfunction definetion//
  28          /*******************************************************************
  29          º¯ÊıÔ­ĞÍ£º
  30          ÊäÈë²ÎÊı£º
  31          Êä³ö²ÎÊı£º
  32          º¯Êı¹¦ÄÜ£º±È½Ï»ñµÃµÄ¿ØÖÆÖ¸ÁîÓëÔ¤ÏÈÉè¶¨µÄÖ¸Áî¶Ô±ÈÊÇ·ñÒ»ÖÂ£¬Èç¹ûÒ»ÖÂ¾ÍÖ´ĞĞÏà¹Ø¹¦ÄÜ£¬·ñÔòÎŞ²Ù×÷
  33          *******************************************************************/
  34          uint8_t char_compare( char *source,  char *dest)
  35          {
  36   1              while(*dest)
  37   1              {       
  38   2                      if((*source!=*dest)||(*source==0)||(*dest==0))
  39   2                              return 1;
  40   2                      source++;
  41   2                      dest++;
  42   2              }
  43   1              return 0;
  44   1      }
  45          
  46          /*******************************************************************
  47          º¯ÊıÔ­ĞÍ£º
  48          ÊäÈë²ÎÊı£º
  49          Êä³ö²ÎÊı£º
  50          º¯Êı¹¦ÄÜ£º°Ñ×Ö·û×ª»¯Îª´úÂë
  51          *******************************************************************/
  52          char char_to_hex(char indata1,char indata2)
  53          {
  54   1              if(indata1>='A')
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 2   

  55   1                      indata1=((indata1-'A')+0x0A);
  56   1              else
  57   1                      indata1=(indata1-'0');
  58   1              if(indata2>='A')
  59   1                      indata2=((indata2-'A')+0x0A);
  60   1              else
  61   1                      indata2=(indata2-'0');
  62   1              return ((indata1<<4)|indata2);
  63   1      }
  64          
  65          /*******************************************************************
  66          º¯ÊıÔ­ĞÍ£º
  67          ÊäÈë²ÎÊı£º
  68          Êä³ö²ÎÊı£º
  69          º¯Êı¹¦ÄÜ£º°Ñ×Ö·û×ª»¯Îª´úÂë
  70          *******************************************************************/
  71          char char_to_bcd(char indata1,char indata2)
  72          {
  73   1              if(indata1>='A')
  74   1                      indata1=((indata1-'A')+0x0A);
  75   1              else
  76   1                      indata1=(indata1-'0');
  77   1              if(indata2>='A')
  78   1                      indata2=((indata2-'A')+0x0A);
  79   1              else
  80   1                      indata2=(indata2-'0');
  81   1              return (indata1*10+indata2);
  82   1      }
  83          
  84          /*******************************************************************
  85          º¯ÊıÔ­ĞÍ£º
  86          ÊäÈë²ÎÊı£º
  87          Êä³ö²ÎÊı£º
  88          º¯Êı¹¦ÄÜ£º°ÑÒª·¢ËÍµÄĞ­Òé×ª»¯Îª×Ö·û
  89          *******************************************************************/
  90          void hex_to_char(uint8_t *p,uint8_t indata)
  91          {
  92   1              uint8_t tmp;
  93   1              tmp=indata>>4;
  94   1              if(tmp>=0x0A)
  95   1               *p=((tmp-0x0A)+'A'); 
  96   1              else
  97   1               *p=(tmp+'0');
  98   1              p++;
  99   1              tmp=indata&0x0F;
 100   1              if(tmp>=0x0A)
 101   1                      *p=((tmp-0x0A)+'A'); 
 102   1              else
 103   1                      *p=(tmp+'0');
 104   1      }
 105          
 106          /*******************************************************************
 107          º¯ÊıÔ­ĞÍ£º
 108          ÊäÈë²ÎÊı£º
 109          Êä³ö²ÎÊı£º
 110          º¯Êı¹¦ÄÜ£º°ÑÒª·¢ËÍµÄĞ­Òé×ª»¯Îª×Ö·û
 111          *******************************************************************/
 112          void hex_to_char_3bit(uint8_t *p, uint8_t indata)
 113          {
 114   1              uint8_t tmp;
 115   1              tmp = indata >> 8;
 116   1              if (tmp >= 0x0A)
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 3   

 117   1                      *p = ((tmp - 0x0A) + 'A');
 118   1              else
 119   1                      *p = (tmp + '0');
 120   1              p++;
 121   1              tmp = (indata&0x0FF) >> 4;
 122   1              if (tmp >= 0x0A)
 123   1                      *p = ((tmp - 0x0A) + 'A');
 124   1              else
 125   1                      *p = (tmp + '0');
 126   1              tmp = indata & 0x00F;
 127   1              if (tmp >= 0x0A)
 128   1                      *p = ((tmp - 0x0A) + 'A');
 129   1              else
 130   1                      *p = (tmp + '0');
 131   1      }
 132          
 133          /*******************************************************************
 134          º¯ÊıÔ­ĞÍ£º
 135          ÊäÈë²ÎÊı£º
 136          Êä³ö²ÎÊı£º
 137          º¯Êı¹¦ÄÜ£º¿ª»úÒª·¢ËÍµÄÃüÁîºÍÏà¹Ø²Ù×÷£¬Õâ¸ö¿ª»úÊÇ°´¼ü°´ÏÂ¿ª»úºÍ½ÓÊÕµ½¡°turn on¡±¿ª»ú£¬
 138                    ÆäËûapp·¢ËÍÑÕÉ«²¢¿ª»úÊ±GP389_ON_APP()º¯Êı
 139          *******************************************************************/
 140          void GP389_ON(void) //
 141          {
 142   1              PlayMode=PLAY_ON;
 143   1              PlayMode=((PlayMode_bk==PLAY_MUSIC)?PLAY_MUSIC:PLAY_ON);//Èç¹û¹Ø»úÊ±ÊÇmusicÄ£Ê½£¬¿ª»ú»Ø¸´´ËÄ£Ê½
 144   1              sys_volume=sys_volume_bk;
 145   1              color_mode=color_mode_bk;
 146   1              //Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);//¹Ø»úÖ®Ç°Èç¹ûÁÁ¶ÈÎª0¾Í»Ö¸´Îª1£¬·ñÔòÎª¹Ø»úÖ
             -®Ç°ÁÁ¶È//2018.4.9¹Ø»úÖ®Ç°ÁÁ¶ÈÎª0£¬¿ª»úÒ²Îª0
 147   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 148   1              
 149   1              Uart0_SendString_3Step=3;
 150   1      }
 151          
 152          /*******************************************************************
 153          º¯ÊıÔ­ĞÍ£º
 154          ÊäÈë²ÎÊı£º
 155          Êä³ö²ÎÊı£º
 156          º¯Êı¹¦ÄÜ£ºapp·¢ËÍÑÕÉ«¡¢µÆ¹â¡¢ÒôÀÖ¸ø»úÌ¨£¨´ËÊ±»úÌ¨Îª¹Ø»ú×´Ì¬£©£¬È»ºó¿ª»ú£¬³ıÁËÒôÁ¿ÆäËû²»»Ö¸´£¬
 157                    Ö»½ÓÊÜĞÂµÄ¹¦ÄÜ²Ù×÷(ÑÕÉ«¡¢µÆ¹â¡¢ÒôÀÖ)
 158          *******************************************************************/
 159          void GP389_ON_APP(void) //
 160          {
 161   1              PlayMode=PLAY_ON;
 162   1              sys_volume=sys_volume_bk;
 163   1              //Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);//¹Ø»úÖ®Ç°Èç¹ûÁÁ¶ÈÎª0¾Í»Ö¸´Îª1£¬·ñÔòÎª¹Ø»úÖ
             -®Ç°ÁÁ¶È//2018.4.9¹Ø»úÖ®Ç°ÁÁ¶ÈÎª0£¬¿ª»úÒ²Îª0
 164   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 165   1              Uart0_SendString_3Step=3;
 166   1      }
 167          
 168          /*******************************************************************
 169          º¯ÊıÔ­ĞÍ£º
 170          ÊäÈë²ÎÊı£º
 171          Êä³ö²ÎÊı£º
 172          º¯Êı¹¦ÄÜ£º°´¼ü¹Ø»úºÍapp¿ØÖÆ¹Ø»úÖ´ĞĞµÄ
 173          *******************************************************************/
 174          void GP389_OFF(void) //
 175          {
 176   1              PlayMode_bk=PlayMode;
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 4   

 177   1              PlayMode=PLAY_OFF;
 178   1              sys_volume_bk=sys_volume;
 179   1              color_mode_bk=color_mode;
 180   1              color_mode=COLOR_OFF;
 181   1              TimerMode=cntTimer=TIMER_OFF;//
 182   1              ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 183   1              Uart0_SendString_3Step=3;
 184   1      }
 185          
 186          /*******************************************************************
 187          º¯ÊıÔ­ĞÍ£º
 188          ÊäÈë²ÎÊı£º
 189          Êä³ö²ÎÊı£º
 190          º¯Êı¹¦ÄÜ£ºÄÖÖÓÔÚÏìÓ¦Ê±²Ù×÷ÔÚAPPÉÏµ÷ÁËµÆ¹âÁÁ¶È£¬ÒôÁ¿´óĞ¡£¬Ôò¹Ø±ÕÄÖÁå²¢¹Ø»ú£¬ÔÚappÉÏµãÁËÌØ¶¨
 191                    ÑÕÉ«µÄµÆ¹â£¬»òÕßµãÁËÌØ¶¨ÒôÀÖ£¬»òÕßµãÁËprogram,ÄÇÃ´ÄÖÖÓÍ£Ö¹£¬ÏìÓ¦ËùµãµÄ²Ù×÷
 192          *******************************************************************/
 193          //void GP389_OFF_AND_AlarmOFF()//ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 194          //{
 195          //      alarm.Runing=0;
 196          //      gbKeyNone=0;
 197          //      GP389_OFF();
 198          //      //color_mode=COLOR_OFF;
 199          //      Uart0_SendString_3Step=5;
 200          //      ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);       
 201          //      TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF;    
 202          //      return;
 203          //}
 204          
 205          /*******************************************************************
 206          º¯ÊıÔ­ĞÍ£º
 207          ÊäÈë²ÎÊı£º
 208          Êä³ö²ÎÊı£º
 209          º¯Êı¹¦ÄÜ£ºÉêÇë¿ª¹Ø»úÊ±µ÷ÓÃ´Ëº¯Êı
 210          *******************************************************************/
 211          void ApplicationGP389_ONOFF(uint8_t onoff)
 212          {//$$${GpSta:[00,00,01,01,FFFFFF,03,0A,00,01E;00,01,00,FFFFFF,03,0A,01,FF,17:3B,FF,02]}\r\n"
 213   1       //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨Ç°10¸ö×Ö¶Î£©·Ö±ğ±íÊ¾£
             -º
 214   1       //¡·ÊÇ·ñ¹Ø»ú,00ÊÇ¿ª»ú£¬01ÊÇ¹Ø»ú
 215   1       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 216   1       //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 217   1       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 218   1       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 219   1       //¡·´ú±íÁÁ¶È( 00 - 03 )
 220   1       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0A )
 221   1       //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 222   1       //¡·´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 223   1       //¡·Ó¢ÎÄ·ÖºÅ¡°;¡±¸ô¿ªÕâÁ½²¿·ÖÃüÁî
 224   1       //¡·ÄÖÖÓ¿ØÖÆĞÅÏ¢£ºÊı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨10¸ö×
             -Ö¶Î£©·Ö±ğ±íÊ¾£º
 225   1       //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 226   1       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 227   1       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 228   1       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 229   1       //¡·´ú±íÁÁ¶È( 00 - 03 )
 230   1       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 231   1       //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 232   1       //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 233   1       //  0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
 234   1       //  0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 235   1       //  0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
 236   1       //  BIT            7       6    5    4    3    2    1    0
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 5   

 237   1       //  ĞÇÆÚx   repeat  ÈÕ  Áù  Îå  ËÄ  Èı  ¶ş  Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î£¬ÕâÒ»´Î
 238   1       //  ÊÇÆßÌìÖ®ÄÚµÄ£¬¼ÙÈç¶¨Ê±13:00£¬²»ÖØ¸´£¬ÄÇÕâ´Î¼ÆÊ±µ½(7*24*60-1)minÖ®ºó½áÊø£¬¼´ÆßÌìÖ®ºó
 239   1       //  µÄ12:59·Ö£©
 240   1       //¡·´ú±íÄÖÖÓÊ±¼ä£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B)
 241   1       //¡·´ú±íÏìÁåÊ±¼ä£¨charÀàĞÍ1¸ö×Ö½Ú£©00-FF (µ¥Î»:·ÖÖÓ)
 242   1              char i;
 243   1              char code respGP389_AllSta[]={"$$${GpSta:[00,00,00,00,000000,00,00,00,000;00,00,00,000000,00,00,00,00,00:
             -00,00,00]}\r\n"};
 244   1              //char code respGP389_AllSta[]={"$$${GpSta:[00,00,00,00,000000,00,00,00,000;00,00,00,000000,]}\r\n"};//ÄÖ
             -ÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 245   1              do{WDT_clear();} while(Uart0_EnableSend);
 246   1              Count200ms_3Step=0;
 247   1              //Uart0_SendString_3Step=0;
 248   1              for(i=0;i<UART0_LEN_BUFFER;i++)
 249   1                      Uart0_TransmitBuffer[i]=0x00;
 250   1              //for(i=0;i<82;i++)//ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 251   1              for(i=0;i<88;i++)
 252   1                      Uart0_TransmitBuffer[i]=respGP389_AllSta[i];
 253   1              hex_to_char(&Uart0_TransmitBuffer[11],onoff);
 254   1              hex_to_char(&Uart0_TransmitBuffer[14],((PlayMode==PLAY_MUSIC)?spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹û
             -ÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 255   1              hex_to_char(&Uart0_TransmitBuffer[17],((color_mode==COLOR_OFF)?0:1));//Îª1Ê±ÊÇÒª¹Ø»ú£¬ËùÒÔÒªºÍcolor_mode_
             -bk¶Ô±È£¬Îª0ÊÇÒª¿ª»ú£¬ÒÑ¾­°Ñcolor_mode_bk¸³Öµ¸øcolor_mode
 256   1              hex_to_char(&Uart0_TransmitBuffer[20],((color_mode==COLOR_CHANGE)?1:0));
 257   1              hex_to_char(&Uart0_TransmitBuffer[23],userR_val);
 258   1              hex_to_char(&Uart0_TransmitBuffer[25],userG_val);       
 259   1              hex_to_char(&Uart0_TransmitBuffer[27],userB_val);
 260   1              hex_to_char(&Uart0_TransmitBuffer[30],Light_Brightness);
 261   1              hex_to_char(&Uart0_TransmitBuffer[33],sys_volume);
 262   1              hex_to_char(&Uart0_TransmitBuffer[36],enable_SPApause);
 263   1              hex_to_char(&Uart0_TransmitBuffer[39],Light_Brightness);//cntTimer);
 264   1              hex_to_char(&Uart0_TransmitBuffer[43],00);//ÄÖÖÓIDºÅÄ¬ÈÏÎª0   //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 265   1              hex_to_char(&Uart0_TransmitBuffer[46],00); //alarm.spa_name);//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹ûÊÇ£¬ÊÇµÚ¼¸Ê×¸è
             -£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 266   1              hex_to_char(&Uart0_TransmitBuffer[49],00); //((alarm.color_mode==COLOR_CHANGE)?1:0));//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­
             -»·½¥±äÄ£Ê½£©
 267   1              hex_to_char(&Uart0_TransmitBuffer[52],00); //alarm.userR_val);
 268   1              hex_to_char(&Uart0_TransmitBuffer[54],00); //alarm.userG_val);  
 269   1              hex_to_char(&Uart0_TransmitBuffer[56],00); //alarm.userB_val);
 270   1              hex_to_char(&Uart0_TransmitBuffer[59],00); //alarm.Brightness);//ÁÁ¶È
 271   1              hex_to_char(&Uart0_TransmitBuffer[62],00); //alarm.volume);//ÒôÁ¿
 272   1              hex_to_char(&Uart0_TransmitBuffer[65],00); //alarm.Enable); //ÄÖÖÓ×Ü¿ª¹Ø
 273   1              hex_to_char(&Uart0_TransmitBuffer[68],00); //alarm.Week);  //ÄÖÖÓÖÜ¼¸ÏìµÍ4Î»
 274   1              hex_to_char(&Uart0_TransmitBuffer[71],00); //alarm.Hour);  //ÄÖÖÓ¶¨Ê±µÄÊ±¼ä£¬Ğ¡Ê±µÍËÄÎ»
 275   1              hex_to_char(&Uart0_TransmitBuffer[74],00); //alarm.Minute);//ÄÖÖÓ¶¨Ê±µÄÊ±¼ä£¬·ÖÖÓµÍËÄÎ»
 276   1              hex_to_char(&Uart0_TransmitBuffer[77],00); //alarm.Duration);//ÄÖÖÓÏìÁåÊ±¼ä£¬µÍËÄÎ»
 277   1              hex_to_char(&Uart0_TransmitBuffer[80],AtomizationMode1);
 278   1              Uart0_SendString_3Step=2;
 279   1              Uart0_Tx_Pointer=0;
 280   1              Uart0_EnableSend=1;
 281   1              Uart0_Tx_TimeOut=20;    
 282   1              USI0DR=Uart0_TransmitBuffer[Uart0_Tx_Pointer++];
 283   1              if(cntFlag_ON_OFF==0)
 284   1                      cntFlag_ON_OFF=2;
 285   1      }
 286          
 287          /*******************************************************************
 288          º¯ÊıÔ­ĞÍ£º
 289          ÊäÈë²ÎÊı£º
 290          Êä³ö²ÎÊı£º
 291          º¯Êı¹¦ÄÜ£º´®¿Ú½ÓÊÕµ½µÄÃüÁîĞ­ÒéºÍÔ¤¶¨µÄĞ­Òé¶Ô±ÈÈ·¶¨ÊÇÄÄ¸ö½ø¶øÖ´ĞĞ²Ù×÷£¬·ñÔòÎŞ²Ù×÷
 292          *******************************************************************/
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 6   

 293          void Wifi_CommandDeal(char *Uart0_Receive)
 294          {
 295   1              uint8_t i;
 296   1              uint8_t temp_time;//ÁÙÊ±ÓÃµÄ±äÁ¿£¬ÔÚ½ÓÊÜ¶¨Ê±Ê±¼äÄÄÀï
 297   1              char *WIFI_CMD;
 298   1              WIFI_CMD=&Uart0_Receive[3];
 299   1      //      if(char_compare(WIFI_CMD,"{AlarmSet")==0)//ok  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 300   1      //      {//$$${AlarmSet:[00,01,00,01,FFFFFF,03,0A,00,00,FF,17:3B,FF,0a/20/00/12/01/01/02]}\r\n
 301   1      //       //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨10¸ö×Ö¶Î£©·Ö±ğ±íÊ¾
             -£º
 302   1      //       //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 303   1      //       //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 304   1      //       //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 305   1      //       //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·,£©
 306   1      //       //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 307   1      //       //¡·£¨È¥µô£©´ú±íµÆÑÕÉ«µÄÏÂ±ê£¬Óëapp½çÃæÖĞµÆÒ»ÖÂ£¬·½±ãµÆ×´Ì¬Í¬²½ÔÆ¶ËºÍapp£¨00-0B£©,ÆäÖĞ00´ú±í¹ØµÆ£¬0A´ú
             -±í²ÊµÆ£¬0B´ú±í×Ô¶¨ÒåÑÕÉ«
 308   1      //       //¡·´ú±íÁÁ¶È( 00 - 03 )
 309   1      //       //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 310   1      //       //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 311   1      //       //¡·(È¥µô)£º´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 312   1      //       //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 313   1      //       //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 314   1      //       //  0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
 315   1      //       //  0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 316   1      //       //  0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
 317   1      //       //  BIT      7       6    5    4    3    2    1    0
 318   1      //       //  ĞÇÆÚx  repeat    ÈÕ   Áù   Îå    ËÄ   Èı   ¶ş   Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î
 319   1      //       //¡·´ú±íÄÖÖÓ¶¨Ê±Ê±¼äµã£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B)
 320   1      //       //¡·´ú±íÏìÁåÊ±¼ä£¨intÀàĞÍ4¸ö×Ö½Ú£©00-FF (µ¥Î»ÓÉÇ¿´ó¶¨Òå)
 321   1      //       //¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£©
 322   1      //       //  ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ 0a/20/00/12/01/01/02
 323   1      //       //(WIFI_CMD[11]-'0')  //ProgrammaµÄIDºÅÔİÊ±Ã»ÓĞ£¬ÎªÒÔºóÀ©Õ¹Ô¤±¸   
 324   1      //              alarm.spa_name  =(WIFI_CMD[15]-'0');//µÚ¼¸Ê×¸è
 325   1      //              if(alarm.spa_name>=7)
 326   1      //                      alarm.spa_name=0;
 327   1      //              alarm.color_mode=(WIFI_CMD[18]-'0');//µÆ¹âµÄ¿ª¹Ø
 328   1      //              alarm.color_mode=(WIFI_CMD[18]=='1')?((WIFI_CMD[21]=='1')?COLOR_CHANGE:COLOR_USER):COLOR_OFF;
 329   1      //              alarm.userR_val=char_to_hex(WIFI_CMD[23],WIFI_CMD[24]);//RÖµ  
 330   1      //              alarm.userG_val=char_to_hex(WIFI_CMD[25],WIFI_CMD[26]);//GÖµ  
 331   1      //              alarm.userB_val=char_to_hex(WIFI_CMD[27],WIFI_CMD[28]);//BÖµ  
 332   1      //              alarm.Brightness=(WIFI_CMD[31]-'0');//ÁÁ¶È
 333   1      //              alarm.volume=char_to_hex(WIFI_CMD[33],WIFI_CMD[34]);//ÒôÁ¿
 334   1      //              alarm.play_pause=WIFI_CMD[37]-'0';//ÔİÍ£²¥·Å
 335   1      //              alarm.Enable=(WIFI_CMD[40]-'0');//ÄÖÖÓ×Ü¿ª¹Ø
 336   1      //              alarm.Week=char_to_hex(WIFI_CMD[42],WIFI_CMD[43]); 
 337   1      //              alarm.Hour=char_to_hex(WIFI_CMD[45],WIFI_CMD[46]);   //ÄÖÖÓÏìµÄĞ¡Ê±µã
 338   1      //              alarm.Minute=char_to_hex(WIFI_CMD[48],WIFI_CMD[49]); 
 339   1      //              alarm.Duration=char_to_hex(WIFI_CMD[51],WIFI_CMD[52]);//³ÖĞøÏìÁåÊ±¼ä£¬×ª»¯ÎªÊıÖµ
 340   1      //              IE3 &= ~0x04;           // Enable WT interrupt
 341   1      //              gRTC_Hour  =char_to_hex(WIFI_CMD[54],WIFI_CMD[55]);
 342   1      //              gRTC_Minute=char_to_hex(WIFI_CMD[57],WIFI_CMD[58]);
 343   1      //              gRTC_Sec   =char_to_hex(WIFI_CMD[60],WIFI_CMD[61]);
 344   1      //              gRTC_Week  =WIFI_CMD[73]-'0';
 345   1      //              gRTC_Week=Week_Table[gRTC_Week];
 346   1      //              IE3 |= 0x04;            // Enable WT interrupt
 347   1      //              if((alarm.Enable)&&(!(alarm.Week&0x7F)))
 348   1      //               Flag_alarm_wake_only=1;
 349   1      //              else
 350   1      //               Flag_alarm_wake_only=0;
 351   1      //      }
 352   1      //      else if(char_compare(WIFI_CMD,"{AlarmOnOff")==0)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 7   

 353   1      //      {//$$${AlarmOnOff:[00,00,10/21/33/12/01/1D/01]}\r\n
 354   1      //       //¡·´ú±í Alarm µÄ ID ºÅ 
 355   1      //       //¡·´ú±íÄÖÖÓµÄ¿ª¹Ø
 356   1      //       //¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£©
 357   1      //       //      ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ  0a/20/00/12/01/01/02
 358   1      //       //(WIFI_CMD[11]-'0')  //ProgrammaµÄIDºÅÔİÊ±Ã»ÓĞ£¬ÎªÒÔºóÀ©Õ¹Ô¤±¸   
 359   1      //              alarm.Enable=(WIFI_CMD[17]-'0'); 
 360   1      //              IE3 &= ~0x04;           // Enable WT interrupt
 361   1      //              gRTC_Hour    =char_to_hex(WIFI_CMD[19],WIFI_CMD[20]);
 362   1      //              gRTC_Minute  =char_to_hex(WIFI_CMD[22],WIFI_CMD[23]);
 363   1      //              gRTC_Sec     =char_to_hex(WIFI_CMD[25],WIFI_CMD[26]);
 364   1      //              gRTC_Week    =WIFI_CMD[38]-'0';
 365   1      //              gRTC_Week=Week_Table[gRTC_Week];
 366   1      //              IE3 |= 0x04;            // Enable WT interrupt
 367   1      //              if((alarm.Enable)&&(!(alarm.Week&0x7F)))
 368   1      //               Flag_alarm_wake_only=1;
 369   1      //              else
 370   1      //               Flag_alarm_wake_only=0;
 371   1      //      }
 372   1                      if(char_compare(WIFI_CMD, "Turn on unit")==0) 
 373   1                      {//$$$Turn on unit\r\n
 374   2                              Uart0Transmit_SendString(Uart0_Receive);
 375   2                              if(PlayMode==PLAY_OFF)
 376   2                              {
 377   3                                      GP389_ON();     
 378   3                                      //ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 379   3                                      return;
 380   3                              }
 381   2                      }
 382   1                      else if(char_compare(WIFI_CMD, "Turn on Lightr")==0)
 383   1                      {//$$$Turn on Lightr\r\n
 384   2                              Uart0Transmit_SendString(Uart0_Receive);
 385   2                              if(PlayMode==PLAY_OFF)
 386   2                                      GP389_ON_APP(); 
 387   2      //                      if(alarm.Runing)//Õâ¸öÒ»¶¨ÊÇ¿ª»ú×´Ì¬²Å½øÈ¥  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 388   2      //                      {
 389   2      //                              alarm.Runing=0;
 390   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 391   2      //                      }
 392   2                              color_mode=color_mode_bk;
 393   2                              if(color_mode==COLOR_OFF)
 394   2                                      color_mode=COLOR_WHITE;
 395   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
 396   2                              return;
 397   2                      }
 398   1                      else if(char_compare(WIFI_CMD, "Change light color")==0)  
 399   1                      {//$$$Change light color Allplay\r\n
 400   2                              Uart0Transmit_SendString(Uart0_Receive);
 401   2                              if(PlayMode==PLAY_OFF)
 402   2                                      GP389_ON_APP();
 403   2      //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 404   2      //                      {//Õâ¸öÒ»¶¨ÊÇ¿ª»úÇé¿öÏÂ½øÈëµÄ
 405   2      //                              alarm.Runing=0;
 406   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 407   2      //                      }
 408   2                              color_mode=COLOR_CHANGE;
 409   2                              play_rgb_index=0;
 410   2                              curR_val=0;
 411   2                              curG_val=0;
 412   2                              curB_val=0;
 413   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
 414   2                              return;
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 8   

 415   2                      } 
 416   1                      else if(char_compare(WIFI_CMD, "User color")==0) 
 417   1                      {//$$$User color FFFFFF\r\n(000000-FFFFFF)
 418   2                              Uart0Transmit_SendString(Uart0_Receive);
 419   2                              if(PlayMode==PLAY_OFF)
 420   2                                      GP389_ON_APP();
 421   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 422   2      //                      {
 423   2      //                              alarm.Runing=0;
 424   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 425   2      //                      }
 426   2                              userR_val=char_to_hex(WIFI_CMD[11],WIFI_CMD[12]);
 427   2                              userG_val=char_to_hex(WIFI_CMD[13],WIFI_CMD[14]);
 428   2                              userB_val=char_to_hex(WIFI_CMD[15],WIFI_CMD[16]);
 429   2                              color_mode=COLOR_USER;
 430   2                              Light_Brightness=((Light_Brightness==0)?1:Light_Brightness);
 431   2                              return;
 432   2                      }
 433   1                      else if(char_compare(WIFI_CMD, "Select Sound file")==0) 
 434   1                      {//$$$Select Sound file to play01\r\n
 435   2                              Uart0Transmit_SendString(Uart0_Receive);
 436   2                              if(PlayMode==PLAY_OFF)
 437   2                                      GP389_ON_APP();
 438   2      //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 439   2      //                      {
 440   2      //                              alarm.Runing=0;
 441   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 442   2      //                      }
 443   2                              enableMute=0;//½âmute
 444   2                              enable_SPApause=0;
 445   2                              PlayMode=PLAY_MUSIC;
 446   2                              spa_name=WIFI_CMD[26]-'0';
 447   2                              if(cur_spa_name==spa_name)
 448   2                                      spa_cmd=SPA_PALY;
 449   2                              Uart0_SendString_3Step=1;
 450   2                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 451   2                              return;
 452   2                      }
 453   1                      else if(char_compare(WIFI_CMD, "music play")==0)
 454   1                      {//$$$music play\r\n
 455   2                              //Uart0Transmit_SendString(Uart0_Receive);
 456   2                              if(PlayMode==PLAY_OFF)
 457   2                                      GP389_ON_APP();
 458   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 459   2      //                      {
 460   2      //                              alarm.Runing=0;
 461   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 462   2      //                      }
 463   2                              PlayMode=PLAY_MUSIC;
 464   2                              enableMute=0;     //½â³ı¾²Òô
 465   2                              enable_SPApause=0;//Îª0±íÊ¾²¥·Å
 466   2                              if(spa_name==SPA_OFF) //spa_nameÎªÃ¶¾Ù±äÁ¿ÀàĞÍ£¬SPA_ZENÎªÃ¶¾Ù±äÁ¿ÔªËØ
 467   2                                      spa_name=SPA_BROOK;
 468   2                              else
 469   2                                      spa_cmd=SPA_PALY;                       
 470   2                              /*if(PlayMode==PLAY_BT)
 471   2                              {
 472   2                                      if(flag_bt_play)
 473   2                                      {
 474   2                                              bt_cmd=BT_PALY;//Ğ­ÒéÀïÃæÊÇÒ»ÌõÃüÁî£¬ËùÒÔ²¥·Å/ÔİÍ£¶¼Òª·¢ËÍÕâÌõ
 475   2                                      }
 476   2                              }*/
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 9   

 477   2                              return;
 478   2                      }
 479   1                      else if(char_compare(WIFI_CMD,"ProPlay\r\n")==0)//½ÓÊÕµ½¾Í²¥·Å×îºóµÄ½ÓÊÕµ½µÄ$$${Program:[00,01,01,00,FFF
             -FFF,03,0A,00,1E]}\r\nÊı¾İ
 480   1                      {//$$${Program
 481   2                              Uart0Transmit_SendString(Uart0_Receive);
 482   2                              if(PlayMode==PLAY_OFF)
 483   2                                      GP389_ON_APP();
 484   2      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 485   2      //                      {
 486   2      //                              alarm.Runing=0;
 487   2      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 488   2      //                      }
 489   2                              spa_name=program1.spa_name;
 490   2                              color_mode=program1.color_mode;
 491   2                              userR_val=program1.userR_val;
 492   2                              userG_val=program1.userG_val;
 493   2                              userB_val=program1.userB_val;
 494   2                              Light_Brightness=program1.Light_Brightness;
 495   2                              sys_volume=program1.sys_volume;
 496   2                              PlayMode=program1.PlayMode;
 497   2                              enable_SPApause=program1.enable_SPApause;
 498   2                              program1.enableMute=enableMute=((enable_SPApause==0)?0:1);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔ
             -ÊĞí²¥·Å¾Í²¥·Å
 499   2                              spa_cmd=((enable_SPApause==0)?SPA_PALY:SPA_PAUSE);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔÊĞí²¥·Å¾
             -Í²¥·Å
 500   2                              TimerMode=program1.TimerMode;
 501   2                              return;
 502   2                      } 
 503   1                      else if (char_compare(WIFI_CMD, "Turn on Humidifier") == 0)
 504   1                      {//$$$Turn on/off Humidifier\r\n
 505   2                              Uart0Transmit_SendString(Uart0_Receive);
 506   2                              if (PlayMode == PLAY_OFF)
 507   2                                      GP389_ON_APP();
 508   2                              //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 509   2                              //                      {
 510   2                              //                              alarm.Runing=0;
 511   2                              //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 512   2                              //                      }
 513   2                              if(AtomizationMode1==ATOMIZATION_OFF) //ÕâÒ»ÌõÊÇÅÂÔÚÎí»¯Æ÷ÒÑ¾­¿ªÆô²¢ÇÒ²»ÔÙ×îĞ¡µµÎ»£¬È»ºóÓÖ½ÓÊÕµ½¿ª»úÃüÁ
             -î±»Ç¿ĞĞ¸ü¸ÄÎª×îĞ¡¶şÉèÁ¢µÄ
 514   2                                      AtomizationMode1 = ATOMIZATION_THREE;
 515   2                              return;
 516   2                      }
 517   1                      else if (char_compare(WIFI_CMD, "Turn off Humidifier") == 0)
 518   1                      {//$$$Turn on/off Humidifier\r\n
 519   2                              Uart0Transmit_SendString(Uart0_Receive);
 520   2                              if (PlayMode == PLAY_OFF)
 521   2                                      GP389_ON_APP();
 522   2                              //                      if(alarm.Runing) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 523   2                              //                      {
 524   2                              //                              alarm.Runing=0;
 525   2                              //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 526   2                              //                      }
 527   2                              AtomizationMode1 = ATOMIZATION_OFF;
 528   2                              return;
 529   2                      }
 530   1      //              else if(char_compare(WIFI_CMD,"{Program")==0)//¹Ø»ú×´Ì¬ÏÂ´ò¿ª
 531   1      //              {//$$${Program:[00,01,01,00,FFFFFF,03,0A,00,1E]}\r\n
 532   1      //                      Uart0Transmit_SendString(Uart0_Receive);
 533   1      //                      if(PlayMode==PLAY_OFF)
 534   1      //                              GP389_ON_APP();
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 10  

 535   1      //                      if(alarm.Runing)
 536   1      //                      {
 537   1      //                              alarm.Runing=0;
 538   1      //                              TimerMode=cntTimer=alarm.cntTimer=TIMER_OFF; 
 539   1      //                      }
 540   1      //                      Program1_LaterNum(); //ÏÈ°ÑµÍÊı×Ö¸³¸ø¸ßÊı×Ö£¬
 541   1      //                      program1.spa_name=spa_name=WIFI_CMD[14]-'0';
 542   1      //                      program1.color_mode=color_mode=((WIFI_CMD[17]=='1')?COLOR_WHITE:COLOR_OFF);//µÆ¹âµÄ¿ª¹Ø
 543   1      //                      program1.color_mode=color_mode=((WIFI_CMD[17]=='1')?((WIFI_CMD[20]=='1')?COLOR_CHANGE:COLOR_USER):COL
             -OR_OFF);//ÏÈÅĞ¶ÏÉÏÒ»×éÊÇ·ñ¿ªÆôµÆ¹â£¬Èç¹û¿ªÆôµÆ¹â¾ÍÔÙÅĞ¶ÏÊÇ·ñ¿ªÆô²ÊµÆ£¬Èç¹û²»¿ªÆô¾ÍÊÇÓÃ»§Öµ                                                                                                                                                                                               //Ó
             -Ã»§ÖµÊÇÏÂÃæRGBµÄÖµ
 544   1      //                      program1.userR_val=userR_val=char_to_hex(WIFI_CMD[22],WIFI_CMD[23]);
 545   1      //                      program1.userG_val=userG_val=char_to_hex(WIFI_CMD[24],WIFI_CMD[25]);
 546   1      //                      program1.userB_val=userB_val=char_to_hex(WIFI_CMD[26],WIFI_CMD[27]);
 547   1      //                      program1.Light_Brightness=Light_Brightness=char_to_bcd(WIFI_CMD[29],WIFI_CMD[30]);
 548   1      //                      program1.sys_volume=sys_volume=char_to_hex(WIFI_CMD[32],WIFI_CMD[33]);//ÒôÁ¿
 549   1      //                      program1.PlayMode=PlayMode=PLAY_MUSIC;
 550   1      //                      program1.enable_SPApause=enable_SPApause=WIFI_CMD[36]-'0';
 551   1      //                      program1.enableMute=enableMute=((enable_SPApause==0)?0:1);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖ
             -ÓÔÊĞí²¥·Å¾Í²¥·Å
 552   1      //                      spa_cmd=((enable_SPApause==0)?SPA_PALY:SPA_PAUSE);//ÎŞÂÛÖ®Ç°²¥·Å»¹ÊÇÔİÍ££¬Ö»ÒªÄÖÖÓÏìÓ¦²¢ÇÒÄÖÖÓÔÊĞí²¥·
             -Å¾Í²¥·Å
 553   1      //                      program1.TimerMode=TimerMode=cntTimer=char_to_hex(WIFI_CMD[38],WIFI_CMD[39]);
 554   1      //                      return;
 555   1      //              }
 556   1                      else if(char_compare(WIFI_CMD,"VER0.\r\n")==0) 
 557   1                      {
 558   2                              return;
 559   2                      }
 560   1                      else if(char_compare(WIFI_CMD,"VER\r\n")==0) 
 561   1                      {
 562   2                              Uart0Transmit_SendString(MCU_VER);//Ã¿´ÎÉı¼¶ĞèÒªÊÖ¶¯¸ÄĞ´ÕâÀï
 563   2                              return;
 564   2                      }
 565   1                      else if(char_compare(WIFI_CMD,"GpSta")==0)
 566   1                      {//×îÖÕ×´Ì¬ÊÇ¹Ø»ú
 567   2                              Uart0_SendString_3Step=0;
 568   2                              cntFlag_ON_OFF=0;
 569   2                              return;//PlayMode=PLAY_OFF;     ÒòÎªÓĞÇ¿ÖÆ¹Ø»ú£¬ËùÒÔ¿ÉÒÔ²»ÒªGP389_OFF()/GP389_ON()
 570   2                      }
 571   1      //              else if(char_compare(WIFI_CMD,"GpSta:[00]\r\n")==0)
 572   1      //              {//×îÖÕ×´Ì¬ÊÇ¿ª»ú£¬
 573   1      //                      Uart0_SendString_3Step=0;
 574   1      //                      cntFlag_ON_OFF=0;
 575   1      //                      return;//PlayMode=PLAY_OFF;     ÒòÎªÓĞÇ¿ÖÆ¹Ø»ú£¬ËùÒÔ¿ÉÒÔ²»ÒªGP389_OFF()/GP389_ON()
 576   1      //              }
 577   1              
 578   1              
 579   1              if(PlayMode!=PLAY_OFF)
 580   1              {
 581   2                      if(char_compare(WIFI_CMD,"{TimeSync")==0)
 582   2                      {//$$${TimeSync:[0A/20/00/12/01/01/02]}\r\n
 583   3                              IE3 &= ~0x04;           // Enable WT interrupt
 584   3                              gRTC_Hour  =char_to_hex(WIFI_CMD[11],WIFI_CMD[12]);
 585   3                              gRTC_Minute=char_to_hex(WIFI_CMD[14],WIFI_CMD[15]);
 586   3                              gRTC_Sec   =char_to_hex(WIFI_CMD[17],WIFI_CMD[18]);
 587   3                              gRTC_Week  =WIFI_CMD[30]-'0';
 588   3                              gRTC_Week  =Week_Table[gRTC_Week];
 589   3                              IE3 |= 0x04;            // Enable WT interrupt
 590   3                              Falg_TimeSync_Allow=0;//½ÓÊÕµ½Í¬²½ĞÅÏ¢¾Í²»ÔÙ·¢ËÍÇëÇóÍ¬²½£¬ËùÒÔÖÃÎª0
 591   3                              return;
 592   3                      }       
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 11  

 593   2                      else if(char_compare(WIFI_CMD, "Turn off unit")==0) 
 594   2                      {//ÕâÌõĞ­ÒéÃüÁîÊÇappÖ±½Ó·¢ËÍ¹ıÀ´µÄ¹Ø»úÃüÁî£¬²»ÓÃÉêÇë¾Í¿ÉÒÔ¹Ø»ú£¬µ«ÊÇÊÕµ½ÕâÌõÃüÁîÒªÅĞ¶Ï
 595   3                       //´ËÊ±²»ÓÃ½øĞĞÅĞ¶ÏÊÇ²»ÊÇÔÚ¹Ø»ú×´Ì¬£¬ÒòÎª¹Ø»úÖ®ºóĞèÒªÉè¶¨µÄ×´Ì¬¶Ô³ÌĞòÎŞÓ°Ïì£¬»òÕß¿ª»úÖ®
 596   3                       //ºó»á³õÊ¼»¯ÕâĞ©×´Ì¬
 597   3                       //$$$Turn off unit\r\n
 598   3                              Uart0Transmit_SendString(Uart0_Receive);
 599   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 600   3      //                      {
 601   3      //                              GP389_OFF_AND_AlarmOFF();
 602   3      //                              return;
 603   3      //                      }
 604   3                              
 605   3                              Uart0_SendString_3Step=3;
 606   3                              GP389_OFF();
 607   3                              //ApplicationGP389_ONOFF((PlayMode==PLAY_OFF)?1:0);
 608   3                              return;
 609   3                      }
 610   2                      else if(char_compare(WIFI_CMD, "Turn on BT")==0) 
 611   2                      {//$$$Turn on BT\r\n
 612   3                              PlayMode=PLAY_BT;
 613   3                      }
 614   2                      else if (char_compare(WIFI_CMD, "previous song\r\n") == 0)
 615   2                      {//$$$previous song\r\n ÉÏÒ»Ê×¸è  
 616   3                              spa_cmd = SPA_PALY;
 617   3                              if ((spa_name > SPA_OFF) && (spa_name <= SPA_ZEN))
 618   3                                      spa_name--;
 619   3                              else
 620   3                                      if (spa_name == SPA_OFF)//ĞÎ³ÉÑ­»·
 621   3                                              spa_name = SPA_ZEN;
 622   3                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 623   3                              return;
 624   3                      }
 625   2                      else if (char_compare(WIFI_CMD, "next song\r\n") == 0)
 626   2                      {//$$$next song\r\n ÏÂÒ»Ê×¸è
 627   3                              spa_cmd = SPA_PALY;
 628   3                              if ((spa_name >= SPA_OFF) && (spa_name < SPA_ZEN))
 629   3                                      spa_name++;
 630   3                              else
 631   3                                      if (spa_name == SPA_ZEN) //ĞÎ³ÉÑ­»·
 632   3                                              spa_name = SPA_OFF;
 633   3                              Uart0Transmit_SendString(&SPASongs_Num_Table[spa_name][0]);//Ã¿´Î¸ü¸ÄÒôÀÖ¾Í·¢¸øappÍ¬²½
 634   3                              return;
 635   3                      }
 636   2                      else if(char_compare(WIFI_CMD, "music pause")==0)
 637   2                      {//$$$music pause\r\n
 638   3                              if(PlayMode==PLAY_MUSIC)
 639   3                              {                                   
 640   4                                      enable_SPApause=1;
 641   4                                      spa_cmd=SPA_PAUSE;
 642   4                              }
 643   3      //                      if(PlayMode==PLAY_BT)
 644   3      //                      {
 645   3      //                              if(flag_bt_play) 
 646   3      //                              {
 647   3      //                                      bt_cmd=BT_PAUSE;//Ğ­ÒéÀïÃæÊÇÒ»ÌõÃüÁî£¬ËùÒÔ²¥·Å/ÔİÍ£¶¼Òª·¢ËÍÕâÌõ
 648   3      //                              }
 649   3      //                      }
 650   3                              return;
 651   3                      }
 652   2                      else if(char_compare(WIFI_CMD,"{MusicStatus")==0)
 653   2                      {
 654   3                              return;
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 12  

 655   3                      }
 656   2                      else if(char_compare(WIFI_CMD, "Adjust Output Volume")==0)
 657   2                      {//$$$Adjust Output Volumexx\r\n£¬xx´ú±í01-10
 658   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 659   3      //                      {
 660   3      //                              GP389_OFF_AND_AlarmOFF();
 661   3      //                              return;
 662   3      //                      }
 663   3                              sys_volume=char_to_bcd(WIFI_CMD[20],WIFI_CMD[21]);
 664   3                              enableMute=0;
 665   3                      }
 666   2                      else if(char_compare(WIFI_CMD, "volume up")==0) 
 667   2                      {//$$$volume up\r\n
 668   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 669   3      //                      {
 670   3      //                              GP389_OFF_AND_AlarmOFF();
 671   3      //                              return;
 672   3      //                      }
 673   3                              sys_volume=((sys_volume < 10)?((sys_volume<=8)?(sys_volume += 2):(sys_volume += 1)):10);
 674   3                              enableMute=0;
 675   3                      }
 676   2                      else if(char_compare(WIFI_CMD, "volume down")==0) 
 677   2                      {//volume down\r\n
 678   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 679   3      //                      {
 680   3      //                              GP389_OFF_AND_AlarmOFF();
 681   3      //                              return;
 682   3      //                      }
 683   3                              sys_volume=((sys_volume > 1)?((sys_volume>=3)?(sys_volume -= 2):(sys_volume -= 1)):1);
 684   3                              enableMute=0;
 685   3                      }
 686   2                      else if(char_compare(WIFI_CMD, "music mute")==0) 
 687   2                      {//$$$music mute\r\n
 688   3                              enableMute=1;
 689   3                              return;
 690   3                      }
 691   2                      else if(char_compare(WIFI_CMD, "music unmute")==0) 
 692   2                      {//$$$music unmute\r\n
 693   3                              enableMute=0;
 694   3                              return;
 695   3                      }
 696   2                      else if(char_compare(WIFI_CMD, "Set Timer")==0)//ok
 697   2                      {//$$$Set Timer XXX\r\n(30/60/90)
 698   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 699   3      //                      {
 700   3      //                              GP389_OFF_AND_AlarmOFF();
 701   3      //                              return;
 702   3      //                      }
 703   3                              temp_time=char_to_bcd(WIFI_CMD[10], WIFI_CMD[11]);//Ö»¼ì²âÇ°Á½¸öÊı×Ö£¬ÔÙÅĞ¶Ï
 704   3                              TimerMode=cntTimer= (temp_time == 90) ? 90 : ((temp_time == 60) ? 60 : ((temp_time == 30) ? 30 : 0));
 705   3                      }
 706   2                      else if(char_compare(WIFI_CMD, "Turn off Timer")==0)//ok
 707   2                      {//$$$Turn off Timer\r\n
 708   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 709   3      //                      {
 710   3      //                              GP389_OFF_AND_AlarmOFF();
 711   3      //                              return;
 712   3      //                      }
 713   3                              TimerMode=cntTimer=TIMER_OFF;
 714   3                      }
 715   2                      else if(char_compare(WIFI_CMD, "Turn off Lightr")==0)  
 716   2                      {//$$$Turn off Lightr\r\n
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 13  

 717   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 718   3      //                      {
 719   3      //                              GP389_OFF_AND_AlarmOFF();
 720   3      //                              return;
 721   3      //                      }
 722   3                              color_mode=COLOR_OFF;
 723   3                      } 
 724   2                      else if(char_compare(WIFI_CMD,"light up")==0)
 725   2                      {//$$$light up\r\n
 726   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 727   3      //                      {
 728   3      //                              GP389_OFF_AND_AlarmOFF();
 729   3      //                              return;
 730   3      //                      }
 731   3                              if(Light_Brightness<3)
 732   3                                      Light_Brightness++;
 733   3                      }
 734   2                      else if(char_compare(WIFI_CMD,"light down")==0)
 735   2                      {//$$$light down\r\n
 736   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 737   3      //                      {
 738   3      //                              GP389_OFF_AND_AlarmOFF();
 739   3      //                              return;
 740   3      //                      }
 741   3                              if(Light_Brightness>0)
 742   3                                      Light_Brightness--;
 743   3                      }
 744   2                      else if(char_compare(WIFI_CMD,"Adjust Light Brightness")==0)
 745   2                      {//$$$Adjust Light Brightness 01\r\n(01-03)
 746   3      //                      if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 747   3      //                      {
 748   3      //                              GP389_OFF_AND_AlarmOFF();
 749   3      //                              return;
 750   3      //                      }
 751   3                              Light_Brightness=char_to_bcd(WIFI_CMD[24],WIFI_CMD[25]);
 752   3                      }
 753   2                      else if (char_compare(WIFI_CMD, "Adjust moist mode") == 0)
 754   2                      {//$$$Adjust moist mode XX\r\n (01-03)
 755   3                       //                     if(alarm.Runing)  //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 756   3                       //                     {
 757   3                       //                             GP389_OFF_AND_AlarmOFF();
 758   3                       //                             return;
 759   3                       //                     }
 760   3                              AtomizationMode1 = char_to_bcd(WIFI_CMD[18], WIFI_CMD[19]);
 761   3                      }
 762   2      //              else if(char_compare(WIFI_CMD,"AlaGpSta\r\n")==0) //ÄÖÖÓ¹¦ÄÜÔÚ001ºÍ003ÖĞÆÁ±ÎÁË
 763   2      //              {//W-G:"$$$AlaGpSta\r\n"
 764   2      //               //G-W:"$$${AlaGpSta:[00,01,01,00,FFFFFF,03,0A,00,01,FF,17:3B,FF]}\r\n"
 765   2      //               //Êı×éÖĞµÚÊı¾İÒÔ¶ººÅ·Ö¸ô£¬Êı×ÖÒÔ 16 ½øÖÆ±íÊ¾£¨ÕâÀï²»Ğ´"0x"£©£¬´Ó×óµ½ÓÒÒÀ´ÎÃ¿¸ö×Ö¶Î£¨13¸ö×Ö¶Î£©·Ö±ğ±íÊ
             -¾£º
 766   2      //               //¡·´ú±í Alarm µÄ ID ºÅ £¨×¢£ºÏÖÔÚÖ»ÓĞÒ»¸öÄÖÖÓ£¬Ä¬ÈÏÎª0£©
 767   2      //               //¡·´ú±íµÚ¼¸Ê×¸è£¨01 - 06£©
 768   2      //               //¡·´ú±í¿ª¹ØµÆ£¨00¹Ø 01¿ª£©
 769   2      //               //¡·´ú±íÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨00 ¹Ø 01 ¿ª£©£¨×¢£º²ÊµÆÑ­»·£¬Îª1¿ªÆôÑ­»·£©
 770   2      //               //¡·´ú±íµÆµÄRGBÖµ£¨000000 - FFFFFF£©£¨²ÊµÆÑ­»·Õâ¸öÖµÎª000000£©
 771   2      //               //¡·´ú±íÁÁ¶È( 00 - 03 )
 772   2      //               //¡·´ú±íÒôÁ¿Öµ ( 00 - 0a )
 773   2      //               //¡·´ú±íÔİÍ£pauseÑ¡Ôñ£¨00±íÊ¾Õı³£²¥·Å,01±íÊ¾ÔİÍ£²¥·Å£©
 774   2      //               //£¨È¥µô£©¡·´ú±í¶¨Ê±Æ÷£¬00(¹Ø/²»¿ªÆô¶¨Ê±)£¬0F(15min)£¬1E(30min)£¬3C(60min)   
 775   2      //               //¡·´ú±íÄÖÖÓ×Ü¿ª¹Ø£¨00 ¹Ø 01: ¿ª£©£¨Ä¬ÈÏ0£©
 776   2      //               //¡·´ú±íÖÜÒ»µ½ÖÜÈÕµÄ¿ª¹Ø£¬Ã¿Ò»ÌìÓÃÒ»¸ö bit ±íÊ¾
 777   2      //               //    0x80 ´ú±íÊÇ·ñÖØ¸´ÄÖÁå
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 14  

 778   2      //               //    0x01 ´ú±íÖÜÒ»Æô¶¯ÄÖÁå£¬µ«ÊÇÖ»ÏìÒ»´Î£¬ÕâÒ»´ÎÊÇÆßÌìÖ®ÄÚµÄ£¬
 779   2      //               //    0xFF ´ú±íÄÖÁåÈ«¿ª£¬²¢ÇÒÃ¿ÖÜÖØ¸´£¬ÒÔ´ËÀàÍÆ
 780   2      //               //    BIT            7       6    5    4    3    2    1    0
 781   2      //               //    ĞÇÆÚx   repeat  ÈÕ  Áù  Îå  ËÄ  Èı  ¶ş  Ò»  £¨×¢£ºrepeatÎªÃ¿ÖÜ¶¼ÖØ¸´ÄÖÁå£¬·ñÔòÖ»ÏìÒ»´Î£¬ÕâÒ»´Î
 782   2      //               //  ÊÇÆßÌìÖ®ÄÚµÄ£¬¼ÙÈç¶¨Ê±13:00£¬²»ÖØ¸´£¬ÄÇÕâ´Î¼ÆÊ±µ½(7*24*60-1)minÖ®ºó½áÊø£¬¼´ÆßÌìÖ®ºó
 783   2      //               //  µÄ12:59·Ö£©
 784   2      //               //¡·´ú±íÄÖÖÓ¶¨Ê±Ê±¼äµã£¨17:3B£©(¶¼ÊÇ16½øÖÆ,:×ó±ßÊÇÄÖÖÓµÄÊ±£¬·¶Î§ÊÇ00-17; :ÓÒ±ßÊÇÄÖÖÓµÄ·Ö£¬·¶Î§ÊÇ00-3B
             -)
 785   2      //               //¡·´ú±íÏìÁåÊ±¼ä£¨charÀàĞÍ1¸ö×Ö½Ú£©00-FF (µ¥Î»:·ÖÖÓ)
 786   2      //               //£¨È¥µô£©¡·´ú±íµ±Ç°Ê±¼ä´Á£¬·Ö±ğ°´ÕÕÊ®Áù½øÖÆÊı¼ÓĞ±¸Ü±íÊ¾£¬¸ñÊ½ÈçÏÂ£º£¨Ê±/·Ö/Ãë/Äê/ÔÂ/ÈÕ/ĞÇÆÚ£© 
 787   2      //               //    ±ÈÈç 2018 Äê 1 ÔÂ 1 ÈÕ 10 Ê± 32 ·Ö 0 ÃëĞÇÆÚ¶ş ÄÇÃ´¸ñÊ½ÊÇ 0a/20/00/12/01/01/02
 788   2      //                      char  code respAlaGpSta[]={"$$${AlaGpSta:[00,00,00,00,000000,00,00,00,00,00,00:00,00]}\r\n"};
 789   2      //                      for(i=0;i<UART0_LEN_BUFFER;i++)
 790   2      //                              Uart0_Receive[i]=0x00;
 791   2      //                      for(i=0;i<62;i++)
 792   2      //                              Uart0_Receive[i]=respAlaGpSta[i];
 793   2      //                      hex_to_char(&Uart0_Receive[14],0);//IDºÅÄ¬ÈÏÎª0
 794   2      //                      hex_to_char(&Uart0_Receive[17],((alarm.spa_name!=0)?alarm.spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹û
             -ÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 795   2      //                      hex_to_char(&Uart0_Receive[20],((alarm.color_mode==COLOR_OFF)?0:1));//¿ª¹ØµÆ
 796   2      //                      hex_to_char(&Uart0_Receive[23],(((alarm.color_mode==COLOR_CHANGE)?1:0)));//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£
             -Ê½£©
 797   2      //                      hex_to_char(&Uart0_Receive[26],alarm.userR_val);
 798   2      //                      hex_to_char(&Uart0_Receive[28],alarm.userG_val);
 799   2      //                      hex_to_char(&Uart0_Receive[30],alarm.userB_val);
 800   2      //                      hex_to_char(&Uart0_Receive[33],alarm.Brightness);//ÁÁ¶È
 801   2      //                      hex_to_char(&Uart0_Receive[36],alarm.volume);//ÒôÁ¿
 802   2      //                      hex_to_char(&Uart0_Receive[39],alarm.play_pause);
 803   2      //                      hex_to_char(&Uart0_Receive[42],alarm.Enable);
 804   2      //                      hex_to_char(&Uart0_Receive[45],alarm.Week);
 805   2      //                      hex_to_char(&Uart0_Receive[48],alarm.Hour);
 806   2      //                      hex_to_char(&Uart0_Receive[51],alarm.Minute);
 807   2      //                      hex_to_char(&Uart0_Receive[54],alarm.Duration);
 808   2      //                      Uart0_SendString_3Step=2;
 809   2      //              }
 810   2                      else if(char_compare(WIFI_CMD,"NorGpSta\r\n")==0)
 811   2                      {//W-G:"$$$NorGpSta\r\n"
 812   3                       //G-W:"$$${NorGpSta:[00,00,01,01,FFFFFF,03,0A,00,01E,02]}\r\n"
 813   3                              char  code respNorGpSta[]={"$$${NorGpSta:[00,00,00,00,000000,00,00,00,000,00]}\r\n"};
 814   3                              for(i=0;i<UART0_LEN_BUFFER;i++)
 815   3                                      Uart0_Receive[i]=0x00;
 816   3                              for(i=0;i<55;i++)
 817   3                                      Uart0_Receive[i]=respNorGpSta[i];
 818   3                              hex_to_char(&Uart0_Receive[14],1);//ÔÚÕâÀïÊÇ¿ª»ú
 819   3                              hex_to_char(&Uart0_Receive[17],((PlayMode==PLAY_MUSIC)?spa_name:7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç¹ûÊÇ£¬Ê
             -ÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 820   3                              hex_to_char(&Uart0_Receive[20],(color_mode==COLOR_OFF)?0:1);
 821   3                              hex_to_char(&Uart0_Receive[23],(color_mode==COLOR_CHANGE)?0:1);//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£Ê½£©
 822   3                              hex_to_char(&Uart0_Receive[26],userR_val);
 823   3                              hex_to_char(&Uart0_Receive[28],userG_val);
 824   3                              hex_to_char(&Uart0_Receive[30],userB_val);
 825   3                              hex_to_char(&Uart0_Receive[33],Light_Brightness);
 826   3                              hex_to_char(&Uart0_Receive[36],sys_volume);
 827   3                              hex_to_char(&Uart0_Receive[39],enable_SPApause);
 828   3                              hex_to_char_3bit(&Uart0_Receive[42],cntTimer);
 829   3                              hex_to_char(&Uart0_Receive[46],AtomizationMode1);
 830   3                              Uart0_SendString_3Step=2;
 831   3                      }
 832   2                      else if(char_compare(WIFI_CMD," update")==0) 
 833   2                      {//mcu update+0X43A4+0X0044,½ÓÊÕµ½Õâ¸öĞÅÏ¢¿ªÊ¼Éı¼¶
 834   3                              Update_ByteSizeSum=(char_to_hex(WIFI_CMD[10],WIFI_CMD[11])<<8)|char_to_hex(WIFI_CMD[12],WIFI_CMD[13]);/
             -/¶àÉÙ¸ö×Ö½Ú£¬µØÎ»ÔÚÇ°£¬¸ßÎ»ÔÚºó
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 15  

 835   3                              Update_PacketSum  =(char_to_hex(WIFI_CMD[17],WIFI_CMD[18])<<8)|char_to_hex(WIFI_CMD[19],WIFI_CMD[20]);/
             -/¶àÉÙ¸ö°ü
 836   3                              update_handle();
 837   3                      }
 838   2                      else if(char_compare(WIFI_CMD,"ATWQ\r\n")==0) 
 839   2                      {//$$$ATWQ\r\n
 840   3                              Uart0_SendString_3Step=0;
 841   3                              return;
 842   3                      }
 843   2                      else if(char_compare(WIFI_CMD,"VER\r\n")==0) 
 844   2                      {
 845   3                              Uart0Transmit_SendString(MCU_VER);//Ã¿´ÎÉı¼¶ĞèÒªÊÖ¶¯¸ÄĞ´ÕâÀï
 846   3                              return;
 847   3                      }
 848   2                      else if(char_compare(WIFI_CMD,"Enter TestMode:")==0) 
 849   2                      {
 850   3                              Uart0_SendString_3Step=0;
 851   3                              cntFlash=0;
 852   3                              Led_Flash=0;
 853   3                              setFactory=1;//ÖÃÒ»ÈÃÈı¸ötimerµÆ³£ÁÁÈıÃë
 854   3                              PlayMode=PLAY_ON;
 855   3                              bt_send_cmd(BT_CLEAR_LIST);//Çå³ıÀ¶ÑÀÁĞ±íÁĞ±í
 856   3                              return;
 857   3                      }
 858   2                      Uart0Transmit_SendString(Uart0_Receive);
 859   2                      ////////////////////////////////////////////////////////////////////////////////////
 860   2                      ////////////////////////////////////////////////////////////////////////////////////
 861   2              }
 862   1              else //¹Ø»ú×´Ì¬ÏÂ½ÓÊÕÌØ¶¨wifiÊı¾İ
 863   1              {
 864   2                      if(char_compare(WIFI_CMD,"{NorGpSta")==0)
 865   2                      {//W-G:"$$$NorGpSta\r\n"
 866   3                       //G-W:"$$${NorGpSta:[00,00,01,01,FFFFFF,03,0A,00,01E,02]}\r\n"
 867   3                              char  code respNorGpSta[] = { "$$${NorGpSta:[00,00,00,00,000000,00,00,00,000,00]}\r\n" };
 868   3                              for (i = 0; i<UART0_LEN_BUFFER; i++)
 869   3                                      Uart0_Receive[i] = 0x00;
 870   3                              for (i = 0; i<55; i++)
 871   3                                      Uart0_Receive[i] = respNorGpSta[i];
 872   3                              hex_to_char(&Uart0_Receive[14], 0);//ÔÚÕâÀïÊÇ¿ª»ú
 873   3                              hex_to_char(&Uart0_Receive[17], ((PlayMode == PLAY_MUSIC) ? spa_name : 7));//Ê×ÏÈÅĞ¶ÏÊÇ²»ÊÇÒôÀÖÄ£Ê½£¬Èç
             -¹ûÊÇ£¬ÊÇµÚ¼¸Ê×¸è£¬Èç¹û²»ÊÇ¾Í·µ»ØÔİÍ££¬7
 874   3                              hex_to_char(&Uart0_Receive[20], (color_mode == COLOR_OFF) ? 0 : 1);
 875   3                              hex_to_char(&Uart0_Receive[23], (color_mode == COLOR_CHANGE) ? 0 : 1);//ÊÇ·ñÊÇ²ÊµÆÄ£Ê½£¨Ñ­»·½¥±äÄ£Ê½£©
 876   3                              hex_to_char(&Uart0_Receive[26], userR_val);
 877   3                              hex_to_char(&Uart0_Receive[28], userG_val);
 878   3                              hex_to_char(&Uart0_Receive[30], userB_val);
 879   3                              hex_to_char(&Uart0_Receive[33], Light_Brightness);
 880   3                              hex_to_char(&Uart0_Receive[36], sys_volume);
 881   3                              hex_to_char(&Uart0_Receive[39], enable_SPApause);
 882   3                              hex_to_char_3bit(&Uart0_Receive[42], cntTimer);
 883   3                              hex_to_char(&Uart0_Receive[46], AtomizationMode1);
 884   3                              Uart0_SendString_3Step = 2;
 885   3                      }
 886   2                      Uart0Transmit_SendString(Uart0_Receive);
 887   2              }
 888   1      }
 889          
 890          /*******************************************************************
 891          º¯ÊıÔ­ĞÍ£º
 892          ÊäÈë²ÎÊı£º
 893          Êä³ö²ÎÊı£º
 894          º¯Êı¹¦ÄÜ£ºÔÚappÉÏ·¢ËÍ¡°×´Ì¬¡°¹¦ÄÜ¸ø»úÌ¨£¬×´Ì¬¹¦ÄÜÊÇÍ¬Ê±ÉèÖÃºÃ¼¸¸ö²Ù×÷£¨ÒôÀÖ£¬µÆ¹âµÈ£©£¬È»ºóÒ»Æğ·¢¹ıÀ´
C51 COMPILER V9.00   WIFI_MODE                                                             08/24/2018 14:39:07 PAGE 16  

 895                    È»ºó»úÌ¨¼ÇÂ¼ÏÂÀ´µÚ¼¸´Î·¢µÄ£¬°ÑĞÂµÄÒ»´Î¸´ÖÆ¸øprogram1£¬ÉÏÒ»´ÎµÄprogram1¸´ÖÆ¸øprogram2£¬ÒòÎª
 896                            Êı¾İºÍÊı¾İÀàĞÍ¶¼Ò»Ñù£¬ËùÒÔ¿ÉÒÔÖ±½Ó¸´ÖÆ
 897          *******************************************************************/
 898          //void Program1_LaterNum()
 899          //{
 900          //      program3=program2;//ÒòÎªÊı¾İºÍÊı¾İÀàĞÍÍêÈ«Ò»Ñù£¬ËùÒÔ¿ÉÒÔÖ±½Ó¸³Öµ
 901          //      program2=program1;
 902          //}
 903          
 904          
 905          
 906          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3463    ----
   CONSTANT SIZE    =    849    ----
   XDATA SIZE       =   ----      14
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
